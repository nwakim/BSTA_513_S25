<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nicky Wakim">
<meta name="dcterms.date" content="2024-04-03">

<title>Lesson 2: Introduction to Categorical Data Analysis ‚Äì Categorical Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-62d5ecfa613c5c5644cabfb02a2f4c65.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-sm " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/Bsta513.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Categorical Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../instructors.html"> 
<span class="menu-text">Instructors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../homeworks.html"> 
<span class="menu-text">Homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../project.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives">Learning Objectives</a></li>
  <li><a href="#learning-objectives-1" id="toc-learning-objectives-1" class="nav-link" data-scroll-target="#learning-objectives-1">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#what-is-categorical-data-analysis" id="toc-what-is-categorical-data-analysis" class="nav-link" data-scroll-target="#what-is-categorical-data-analysis">What is Categorical Data Analysis?</a></li>
  <li><a href="#types-of-variables" id="toc-types-of-variables" class="nav-link" data-scroll-target="#types-of-variables">Types of Variables</a></li>
  <li><a href="#types-of-variables-outcomes-we-will-cover-in-this-course" id="toc-types-of-variables-outcomes-we-will-cover-in-this-course" class="nav-link" data-scroll-target="#types-of-variables-outcomes-we-will-cover-in-this-course">Types of Variables: Outcomes we will cover in this course</a></li>
  <li><a href="#what-does-this-course-cover" id="toc-what-does-this-course-cover" class="nav-link" data-scroll-target="#what-does-this-course-cover">What does this course cover?</a></li>
  <li><a href="#poll-everywhere-question-1" id="toc-poll-everywhere-question-1" class="nav-link" data-scroll-target="#poll-everywhere-question-1">Poll everywhere question 1</a></li>
  </ul></li>
  <li><a href="#learning-objectives-2" id="toc-learning-objectives-2" class="nav-link" data-scroll-target="#learning-objectives-2">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#binomial-distribution" id="toc-binomial-distribution" class="nav-link" data-scroll-target="#binomial-distribution">Binomial Distribution</a></li>
  <li><a href="#binomial-distribution-1" id="toc-binomial-distribution-1" class="nav-link" data-scroll-target="#binomial-distribution-1">Binomial Distribution</a></li>
  <li><a href="#binomial-distribution-r-commands" id="toc-binomial-distribution-r-commands" class="nav-link" data-scroll-target="#binomial-distribution-r-commands">Binomial Distribution: R commands</a></li>
  <li><a href="#binomial-distribution-example" id="toc-binomial-distribution-example" class="nav-link" data-scroll-target="#binomial-distribution-example">Binomial Distribution Example</a></li>
  <li><a href="#normal-approximation-of-the-binomial-distribution" id="toc-normal-approximation-of-the-binomial-distribution" class="nav-link" data-scroll-target="#normal-approximation-of-the-binomial-distribution">Normal Approximation of the Binomial Distribution</a></li>
  </ul></li>
  <li><a href="#learning-objectives-3" id="toc-learning-objectives-3" class="nav-link" data-scroll-target="#learning-objectives-3">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#estimate-and-confidence-interval-of-single-proportion" id="toc-estimate-and-confidence-interval-of-single-proportion" class="nav-link" data-scroll-target="#estimate-and-confidence-interval-of-single-proportion">Estimate and Confidence Interval of Single Proportion</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"></a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"></a></li>
  <li><a href="#poll-everywhere-question-2" id="toc-poll-everywhere-question-2" class="nav-link" data-scroll-target="#poll-everywhere-question-2">Poll everywhere question 2</a></li>
  </ul></li>
  <li><a href="#learning-objectives-4" id="toc-learning-objectives-4" class="nav-link" data-scroll-target="#learning-objectives-4">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#estimate-and-confidence-interval-for-difference-in-proportions" id="toc-estimate-and-confidence-interval-for-difference-in-proportions" class="nav-link" data-scroll-target="#estimate-and-confidence-interval-for-difference-in-proportions">Estimate and Confidence Interval for Difference in Proportions</a></li>
  <li><a href="#poll-everywhere-question-3" id="toc-poll-everywhere-question-3" class="nav-link" data-scroll-target="#poll-everywhere-question-3">Poll Everywhere Question 3</a></li>
  <li><a href="#example-strong-heart-study-12" id="toc-example-strong-heart-study-12" class="nav-link" data-scroll-target="#example-strong-heart-study-12">Example: Strong Heart Study (1/2)</a></li>
  <li><a href="#example-strong-heart-study-22" id="toc-example-strong-heart-study-22" class="nav-link" data-scroll-target="#example-strong-heart-study-22">Example: Strong Heart Study (2/2)</a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"></a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"></a></li>
  <li><a href="#mcnemars-test" id="toc-mcnemars-test" class="nav-link" data-scroll-target="#mcnemars-test">McNemar‚Äôs Test</a></li>
  <li><a href="#summary-so-far" id="toc-summary-so-far" class="nav-link" data-scroll-target="#summary-so-far">Summary so far</a></li>
  </ul></li>
  <li><a href="#learning-objectives-5" id="toc-learning-objectives-5" class="nav-link" data-scroll-target="#learning-objectives-5">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#contingency-tables-r-x-c" id="toc-contingency-tables-r-x-c" class="nav-link" data-scroll-target="#contingency-tables-r-x-c">Contingency Tables (R x C)</a></li>
  <li><a href="#contingency-table-example" id="toc-contingency-table-example" class="nav-link" data-scroll-target="#contingency-table-example">Contingency Table: Example</a></li>
  <li><a href="#test-associationtrend-of-r-x-c-contingency-table" id="toc-test-associationtrend-of-r-x-c-contingency-table" class="nav-link" data-scroll-target="#test-associationtrend-of-r-x-c-contingency-table">Test Association/Trend of R X C Contingency Table</a></li>
  <li><a href="#poll-everywhere-question-4" id="toc-poll-everywhere-question-4" class="nav-link" data-scroll-target="#poll-everywhere-question-4">Poll Everywhere Question 4</a></li>
  <li><a href="#test-of-general-association" id="toc-test-of-general-association" class="nav-link" data-scroll-target="#test-of-general-association">Test of General Association</a></li>
  <li><a href="#test-of-general-association-shs-example" id="toc-test-of-general-association-shs-example" class="nav-link" data-scroll-target="#test-of-general-association-shs-example">Test of General Association: SHS Example</a></li>
  </ul></li>
  <li><a href="#learning-objectives-6" id="toc-learning-objectives-6" class="nav-link" data-scroll-target="#learning-objectives-6">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#chi-squared-test" id="toc-chi-squared-test" class="nav-link" data-scroll-target="#chi-squared-test">Chi-squared test</a></li>
  <li><a href="#chi-squared-test-process" id="toc-chi-squared-test-process" class="nav-link" data-scroll-target="#chi-squared-test-process">Chi-squared test: Process</a></li>
  <li><a href="#chi-squared-test-expected-cell-counts" id="toc-chi-squared-test-expected-cell-counts" class="nav-link" data-scroll-target="#chi-squared-test-expected-cell-counts">Chi-squared test: Expected Cell Counts</a></li>
  <li><a href="#chi-squared-test-expected-cell-counts-1" id="toc-chi-squared-test-expected-cell-counts-1" class="nav-link" data-scroll-target="#chi-squared-test-expected-cell-counts-1">Chi-squared test: Expected Cell Counts</a></li>
  <li><a href="#chi-squared-test-shs-example" id="toc-chi-squared-test-shs-example" class="nav-link" data-scroll-target="#chi-squared-test-shs-example">Chi-squared test: SHS Example</a></li>
  </ul></li>
  <li><a href="#learning-objectives-7" id="toc-learning-objectives-7" class="nav-link" data-scroll-target="#learning-objectives-7">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#fishers-exact-test" id="toc-fishers-exact-test" class="nav-link" data-scroll-target="#fishers-exact-test">Fisher‚Äôs Exact Test</a></li>
  <li><a href="#fishers-exact-test-process" id="toc-fishers-exact-test-process" class="nav-link" data-scroll-target="#fishers-exact-test-process">Fisher‚Äôs Exact test: Process</a></li>
  <li><a href="#fishers-exact-test-shs-example-not-appropriate-use-of-fishers-exact" id="toc-fishers-exact-test-shs-example-not-appropriate-use-of-fishers-exact" class="nav-link" data-scroll-target="#fishers-exact-test-shs-example-not-appropriate-use-of-fishers-exact">Fisher‚Äôs Exact test: SHS Example (not appropriate use of Fisher‚Äôs Exact)</a></li>
  </ul></li>
  <li><a href="#learning-objectives-8" id="toc-learning-objectives-8" class="nav-link" data-scroll-target="#learning-objectives-8">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#test-of-trend" id="toc-test-of-trend" class="nav-link" data-scroll-target="#test-of-trend">Test of Trend</a></li>
  <li><a href="#cochran-armitage-test" id="toc-cochran-armitage-test" class="nav-link" data-scroll-target="#cochran-armitage-test">Cochran-Armitage test</a></li>
  <li><a href="#cochran-armitage-test-hypothesis-test" id="toc-cochran-armitage-test-hypothesis-test" class="nav-link" data-scroll-target="#cochran-armitage-test-hypothesis-test">Cochran-Armitage test: Hypothesis Test</a></li>
  <li><a href="#cochran-armitage-test-process" id="toc-cochran-armitage-test-process" class="nav-link" data-scroll-target="#cochran-armitage-test-process">Cochran-Armitage test: Process</a></li>
  <li><a href="#cochran-armitage-test-example-13" id="toc-cochran-armitage-test-example-13" class="nav-link" data-scroll-target="#cochran-armitage-test-example-13">Cochran-Armitage test: Example (1/3)</a></li>
  <li><a href="#cochran-armitage-test-example-23" id="toc-cochran-armitage-test-example-23" class="nav-link" data-scroll-target="#cochran-armitage-test-example-23">Cochran-Armitage test: Example (2/3)</a></li>
  <li><a href="#cochran-armitage-test-example-33" id="toc-cochran-armitage-test-example-33" class="nav-link" data-scroll-target="#cochran-armitage-test-example-33">Cochran-Armitage test: Example (3/3)</a></li>
  </ul></li>
  <li><a href="#learning-objectives-9" id="toc-learning-objectives-9" class="nav-link" data-scroll-target="#learning-objectives-9">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#mantel-haenszel-test" id="toc-mantel-haenszel-test" class="nav-link" data-scroll-target="#mantel-haenszel-test">Mantel-Haenszel test</a></li>
  <li><a href="#mantel-haenszel-test-process" id="toc-mantel-haenszel-test-process" class="nav-link" data-scroll-target="#mantel-haenszel-test-process">Mantel-Haenszel test: Process</a></li>
  <li><a href="#mantel-haenszel-test-example-13" id="toc-mantel-haenszel-test-example-13" class="nav-link" data-scroll-target="#mantel-haenszel-test-example-13">Mantel-Haenszel test: Example (1/3)</a></li>
  <li><a href="#mantel-haenszel-test-example-23" id="toc-mantel-haenszel-test-example-23" class="nav-link" data-scroll-target="#mantel-haenszel-test-example-23">Mantel-Haenszel test: Example (2/3)</a></li>
  <li><a href="#mantel-haenszel-test-example-33" id="toc-mantel-haenszel-test-example-33" class="nav-link" data-scroll-target="#mantel-haenszel-test-example-33">Mantel-Haenszel test: Example (3/3)</a></li>
  </ul></li>
  <li><a href="#learning-objectives-10" id="toc-learning-objectives-10" class="nav-link" data-scroll-target="#learning-objectives-10">Learning Objectives</a>
  <ul class="collapse">
  <li><a href="#more-resources" id="toc-more-resources" class="nav-link" data-scroll-target="#more-resources">More resources</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="02_Intro_CDA.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lesson 2: Introduction to Categorical Data Analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nicky Wakim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 3, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ
‚úî dplyr     1.1.4     ‚úî readr     2.1.5
‚úî forcats   1.0.0     ‚úî stringr   1.5.1
‚úî ggplot2   3.5.1     ‚úî tibble    3.2.1
‚úî lubridate 1.9.3     ‚úî tidyr     1.3.1
‚úî purrr     1.0.2     
‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
‚úñ dplyr::filter() masks stats::filter()
‚úñ dplyr::lag()    masks stats::lag()
‚Ñπ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors

Attaching package: 'janitor'


The following objects are masked from 'package:stats':

    chisq.test, fisher.test



Attaching package: 'rstatix'


The following object is masked from 'package:janitor':

    make_clean_names


The following object is masked from 'package:stats':

    filter


here() starts at /Users/wakim/Library/CloudStorage/OneDrive-OregonHealth&amp;ScienceUniversity/Teaching/Classes/S25_BSTA_513/S25_BSTA_513_site</code></pre>
</div>
</div>
<section id="learning-objectives" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Recognize the motivation for and focus of our course (categorical responses)</p></li>
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
<li><p>Determine if a single proportion differs from a population value</p></li>
<li><p>Determine if two proportions differ from each other</p></li>
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
<li><p>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</p></li>
</ol>
</section>
<section id="learning-objectives-1" class="level1">
<h1>Learning Objectives</h1>
<div class="lob">
<ol type="1">
<li>Recognize the motivation for and focus of our course (categorical responses)</li>
</ol>
</div>
<ol start="2" type="1">
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
<li><p>Determine if a single proportion differs from a population value</p></li>
<li><p>Determine if two proportions differ from each other</p></li>
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
<li><p>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</p></li>
</ol>
<section id="what-is-categorical-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="what-is-categorical-data-analysis">What is Categorical Data Analysis?</h2>
<ul>
<li><p>In BSTA 512/612 (linear regression), we focused on <span style="color:#70AD47; font-weight: bold;">continuous responses/outcomes</span></p>
<ul>
<li><p>We included <span style="color:#70AD47; font-weight: bold;">categorical variables only as covariates</span> (aka predictors, independent variables, explanatory variables)</p></li>
<li><p>Examples from 512/612: life expectancy (in years), IAT score (ranging from -2 to 2)</p></li>
</ul></li>
</ul>
<p>&nbsp; &nbsp;</p>
<ul>
<li><p>Categorical data analysis focuses on the statistical methods for <span style="color:#4472C4; font-weight: bold;">categorical responses/outcomes</span></p>
<ul>
<li>Explanatory (or ‚Äòindependent‚Äô) variable can be of any type (continuous or categorical)</li>
</ul></li>
</ul>
</section>
<section id="types-of-variables" class="level2">
<h2 class="anchored" data-anchor-id="types-of-variables">Types of Variables</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/types_data.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="types-of-variables-outcomes-we-will-cover-in-this-course" class="level2">
<h2 class="anchored" data-anchor-id="types-of-variables-outcomes-we-will-cover-in-this-course">Types of Variables: Outcomes we will cover in this course</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/types_data_2.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="what-does-this-course-cover" class="level2">
<h2 class="anchored" data-anchor-id="what-does-this-course-cover">What does this course cover?</h2>
<ul>
<li><p>Strategies for assessing association between categorical response variable and a <span style="color:#70AD47; font-weight: bold;">one explanatory variable</span></p>
<ul>
<li>Hypothesis testing</li>
<li>Measure of association</li>
<li>Simple logistic regression</li>
</ul></li>
</ul>
<p>&nbsp; &nbsp;</p>
<ul>
<li><p>Statistical modeling strategies for assessing association between the categorical response variable and a <span style="color:#4472C4; font-weight: bold;">set of explanatory variables</span></p>
<ul>
<li><p>Logistic regression</p>
<ul>
<li>For binary, ordinal, and multinomial outcomes</li>
</ul></li>
<li><p>Poisson regression</p>
<ul>
<li>For counts outcomes</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="poll-everywhere-question-1" class="level2">
<h2 class="anchored" data-anchor-id="poll-everywhere-question-1">Poll everywhere question 1</h2>
</section>
</section>
<section id="learning-objectives-2" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li>Recognize the motivation for and focus of our course (categorical responses)</li>
</ol>
<div class="lob">
<ol start="2" type="1">
<li>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</li>
</ol>
</div>
<ol start="3" type="1">
<li><p>Determine if a single proportion differs from a population value</p></li>
<li><p>Determine if two proportions differ from each other</p></li>
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
<li><p>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</p></li>
</ol>
<section id="binomial-distribution" class="level2">
<h2 class="anchored" data-anchor-id="binomial-distribution">Binomial Distribution</h2>
<ul>
<li><p>Consider a sample of <span class="math inline">\(n\)</span> independent trials, each of which can have only two possible outcomes (‚Äúsuccess‚Äù and ‚Äúfailure‚Äù)</p></li>
<li><p>For each trial: <span class="math display">\[\begin{align} P( \text{success}) &amp; = p \\
                  P( \text{failure}) &amp; = 1- p = q \end{align}\]</span></p></li>
<li><p><strong>Binomial distribution:</strong> distribution of the number of successes in n independent trials</p></li>
<li><p>The probability mass function for the binomial distribution is: <span class="math display">\[P(X=k) = {n \choose k} p^k q^{n-k}, \text{ for } k = 0, 1, ..., n\]</span></p>
<ul>
<li><span class="math inline">\(E(X) = np\)</span></li>
<li><span class="math inline">\(Var(X) = npq = np(1-p)\)</span></li>
</ul></li>
</ul>
</section>
<section id="binomial-distribution-1" class="level2">
<h2 class="anchored" data-anchor-id="binomial-distribution-1">Binomial Distribution</h2>
<ul>
<li><p>Consider a sample of <span class="math inline">\(n\)</span> independent trials, each of which can have only two possible outcomes (‚Äúsuccess‚Äù and ‚Äúfailure‚Äù)</p></li>
<li><p>For each trial: <span class="math display">\[\begin{align} P( \text{success}) &amp; = p \\
                  P( \text{failure}) &amp; = 1- p = q \end{align}\]</span></p></li>
<li><p><strong>Binomial distribution:</strong> distribution of the number of successes in n independent trials</p></li>
<li><p>The probability mass function for the binomial distribution is: <span class="math display">\[P(X=k) = {n \choose k} p^k q^{n-k}, \text{ for } k = 0, 1, ..., n\]</span></p>
<ul>
<li><span class="math inline">\(E(X) = np\)</span></li>
<li><span class="math inline">\(Var(X) = npq = np(1-p)\)</span></li>
</ul></li>
</ul>
<p><img src="./images/binomial_q.png" class="absolute img-fluid" data-top="70%" data-right="5%" width="800"></p>
</section>
<section id="binomial-distribution-r-commands" class="level2">
<h2 class="anchored" data-anchor-id="binomial-distribution-r-commands">Binomial Distribution: R commands</h2>
<p>R commands with their <span style="color:#70AD47">input</span> and <span style="color:#4472C4">output</span>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>R code</th>
<th>What does it return?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>rbinom()</code></td>
<td>returns <span style="color:#4472C4">sample of random variables</span> with <span style="color:#70AD47">specified binomial distribution</span></td>
</tr>
<tr class="even">
<td><code>dbinom()</code></td>
<td>returns <span style="color:#4472C4">probability</span> of getting <span style="color:#70AD47">certain number of successes</span></td>
</tr>
<tr class="odd">
<td><code>pbinom()</code></td>
<td>returns <span style="color:#4472C4">cumulative probability</span> of getting <span style="color:#70AD47">certain number or less</span> successes</td>
</tr>
<tr class="even">
<td><code>qbinom()</code></td>
<td>returns <span style="color:#4472C4">number of successes</span> corresponding to <span style="color:#70AD47">desired quantile</span></td>
</tr>
</tbody>
</table>
</section>
<section id="binomial-distribution-example" class="level2">
<h2 class="anchored" data-anchor-id="binomial-distribution-example">Binomial Distribution Example</h2>
<div class="example">
<div class="ex-title">
<p>Example</p>
</div>
<div class="ex-cont">
<p>If the probability that one white blood cell is a lymphocyte is 0.2, compute the probability of 2 lymphocytes out of 10 white blood cells</p>
</div>
</div>
<p><span class="math display">\[P(X=2) = {10 \choose 2} 0.2^2 (1-0.2)^{10-2}  = 0.3020\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="fl">0.2</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.302</code></pre>
</div>
</div>
</section>
<section id="normal-approximation-of-the-binomial-distribution" class="level2">
<h2 class="anchored" data-anchor-id="normal-approximation-of-the-binomial-distribution">Normal Approximation of the Binomial Distribution</h2>
<ul>
<li><p>Also known as: <strong>Sampling distribution of</strong> <span class="math inline">\(\widehat{p}\)</span></p></li>
<li><p>IF <span class="math inline">\(X\sim \text{Binomial}(n,p)\)</span> and <span class="math inline">\(np&gt;10\)</span> and <span class="math inline">\(nq = n(1-p) &gt; 10\)</span></p>
<ul>
<li>Ensures sample size (<span class="math inline">\(n\)</span>) is moderately large and the <span class="math inline">\(p\)</span> is not too close to 0 or 1</li>
<li>Other resources use other criteria (like <span class="math inline">\(npq&gt;5\)</span> or <span class="math inline">\(np&gt;5\)</span>)</li>
<li>When looking at a sample, we use <span class="math inline">\(\widehat{p}\)</span> instead of <span class="math inline">\(p\)</span> to check this!!</li>
</ul></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>THEN approximately <span class="math inline">\(ùëã\sim \text{Normal}\big(\mu_X = np, \sigma_X = \sqrt{np(1-p)} \big)\)</span></p>
<ul>
<li>Or we often write this as the sampling distribution of <span class="math inline">\(\widehat{p}\)</span>: <span class="math display">\[\widehat{p} \sim \text{Normal}\bigg(\mu_{\widehat{p}} = p, \sigma_{\widehat{p}} = \sqrt{\dfrac{p(1-p)}{n}}\bigg)\]</span></li>
</ul></li>
<li><p><a href="https://www.youtube.com/watch?v=CCqWkJ_pqNU&amp;ab_channel=jbstatistics">Pretty good video behind the intuition of this</a> (Watch 00:00 - 05:40)</p></li>
</ul>
</section>
</section>
<section id="learning-objectives-3" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Recognize the motivation for and focus of our course (categorical responses)</p></li>
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
</ol>
<div class="lob">
<ol start="3" type="1">
<li>Determine if a single proportion differs from a population value</li>
</ol>
</div>
<ol start="4" type="1">
<li><p>Determine if two proportions differ from each other</p></li>
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
<li><p>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</p></li>
</ol>
<section id="estimate-and-confidence-interval-of-single-proportion" class="level2">
<h2 class="anchored" data-anchor-id="estimate-and-confidence-interval-of-single-proportion">Estimate and Confidence Interval of Single Proportion</h2>
<ul>
<li>Estimate of proportion:</li>
</ul>
<p><span class="math display">\[
\widehat{p} = \dfrac{\# \text{successes}}{\# \text{successes} + \# \text{failures}}
\]</span></p>
<ul>
<li><p>Use the sampling distribution of <span class="math inline">\(\widehat{p}\)</span> to construct the confidence interval:</p>
<ul>
<li><span class="math inline">\((1-\alpha)\%\)</span> confidence interval for estimate proportion:</li>
</ul></li>
</ul>
<p><span class="math display">\[\begin{align} \widehat{p} &amp;\pm z^*_{(1-\alpha/2)} \cdot SE_{\hat{p}} \\ \widehat{p} &amp;\pm z^*_{(1-\alpha/2)} \cdot \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} \end{align}\]</span></p>
<ul>
<li>Using <span class="math inline">\(SE_{\hat{p}} = \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\)</span> - instead of <span class="math inline">\(\sigma_{p} = \sqrt{\frac{p(1-p)}{n}}\)</span> - because we don‚Äôt know exactly what <span class="math inline">\(p\)</span> is</li>
</ul>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section"></h2>
<div class="example">
<div class="ex-title">
<p>Smoking status example</p>
</div>
<div class="ex-cont">
<p>A cross-sectional study of 8681 patients was conducted to evaluate the nature of smoking status among people. Of the 8681 people, 4840 were nonsmokers and 3841 were smokers.</p>
</div>
</div>
<p><strong>Needed steps:</strong></p>
<ol type="1">
<li>Estimate proportion <span class="math inline">\(\widehat{p}\)</span></li>
<li>Check that <span class="math inline">\(n\widehat{p}&gt;10\)</span> and <span class="math inline">\(n(1-\widehat{p})&gt;10\)</span> in order to make normal approximation</li>
<li>Construct 95% confidence interval</li>
<li>Write interpretation</li>
</ol>
</section>
<section id="section-1" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="section-1"></h2>
<div class="example">
<div class="ex-title">
<p>Smoking status example</p>
</div>
<div class="ex-cont">
<p>A cross-sectional study of 8681 patients was conducted to evaluate the nature of smoking status among people. Of the 8681 people, 4840 were nonsmokers and 3841 were smokers.</p>
</div>
</div>
<div class="columns">
<div class="column">
<ol type="1">
<li>Estimate proportion <span class="math inline">\(\widehat{p}\)</span> <span class="math display">\[ \widehat{p} = \dfrac{3841}{3841 + 4840} = \dfrac{3841}{8681} = 0.44246\]</span></li>
<li>Check that <span class="math inline">\(n\widehat{p}&gt;10\)</span> and <span class="math inline">\(n(1-\widehat{p})&gt;10\)</span> in order to make normal approximation <span class="math display">\[ n\widehat{p} = 8681\cdot0.4425 = 3841 &gt; 10\]</span> <span class="math display">\[ n(1-\widehat{p}) = 8681\cdot(1-0.4425) = 4840 &gt; 10\]</span></li>
</ol>
</div><div class="column">
<ol start="3" type="1">
<li>Construct 95% confidence interval</li>
</ol>
<p><span class="math display">\[ \widehat{p} \pm z^*_{0.975} \cdot \sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="dv">3841</span>, <span class="at">n =</span> <span class="dv">8681</span>, <span class="at">correct =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  3841 out of 8681, null probability 0.5
X-squared = 114.73, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.4319827 0.4529896
sample estimates:
        p 
0.4424605 </code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Write interpretation of <strong>estimate</strong></li>
</ol>
<p>The estimated proportion of smokers is 0.442 (95% CI: 0.432, 0.453).</p>
<p>Additional interpretation of CI: We are 95% confident that the (population) proportion of smokers is between 0.432 and 0.453.</p>
</div>
</div>
</section>
<section id="poll-everywhere-question-2" class="level2">
<h2 class="anchored" data-anchor-id="poll-everywhere-question-2">Poll everywhere question 2</h2>
</section>
</section>
<section id="learning-objectives-4" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Recognize the motivation for and focus of our course (categorical responses)</p></li>
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
<li><p>Determine if a single proportion differs from a population value</p></li>
</ol>
<div class="lob">
<ol start="4" type="1">
<li>Determine if two proportions differ from each other</li>
</ol>
</div>
<ol start="5" type="1">
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
<li><p>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</p></li>
</ol>
<section id="estimate-and-confidence-interval-for-difference-in-proportions" class="level2">
<h2 class="anchored" data-anchor-id="estimate-and-confidence-interval-for-difference-in-proportions">Estimate and Confidence Interval for Difference in Proportions</h2>
<ul>
<li><p>Use the sampling distribution of <span class="math inline">\(\widehat{p}_1\)</span> and <span class="math inline">\(\widehat{p}_2\)</span> to construct the confidence interval:</p>
<ul>
<li><span class="math inline">\((1-\alpha)\%\)</span> confidence interval for estimate difference in proportions:</li>
</ul></li>
</ul>
<p><span class="math display">\[\begin{align} \widehat{p}_1 - \widehat{p}_2 &amp;\pm z^*_{(1-\alpha/2)} \cdot SE_{\hat{p}_1 - \hat{p}_2} \\ \widehat{p}_1 - \widehat{p}_2 &amp;\pm z^*_{(1-\alpha/2)} \cdot \sqrt{
\frac{\hat{p}_1\cdot(1-\hat{p}_1)}{n_1} + \frac{\hat{p}_2\cdot(1-\hat{p}_2)}{n_2}} \end{align}\]</span></p>
<ul>
<li>Using <span class="math inline">\(SE_{\hat{p}_1 - \hat{p}_2} = \sqrt{\frac{\hat{p}_1\cdot(1-\hat{p}_1)}{n_1} + \frac{\hat{p}_2\cdot(1-\hat{p}_2)}{n_2}}\)</span> because we don‚Äôt know exactly what <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span> are</li>
</ul>
</section>
<section id="poll-everywhere-question-3" class="level2">
<h2 class="anchored" data-anchor-id="poll-everywhere-question-3">Poll Everywhere Question 3</h2>
</section>
<section id="example-strong-heart-study-12" class="level2">
<h2 class="anchored" data-anchor-id="example-strong-heart-study-12">Example: Strong Heart Study (1/2)</h2>
<div class="columns">
<div class="column" style="width:65%;">
<p>The <a href="https://strongheartstudy.org/">Strong Heart Study</a> is an ongoing study of American Indians residing in 13 tribal communities in three geographic areas (AZ, OK, and SD/ND) to study prevalence and incidence of cardiovascular disease and to identify risk factors. We will be examining the 4-year cumulative incidence of diabetes with one risk factor, glucose tolerance.</p>
<p>&nbsp;</p>
<ul>
<li><p><strong>Impaired glucose:</strong> normal or impaired glucose tolerance at baseline visit (between 1988 and 1991)</p>
<p>&nbsp;</p></li>
<li><p><strong>Diabetes:</strong> Indicator of diabetes at follow-up visit (roughly four years after baseline) according to two-hour oral glucose tolerance test</p></li>
</ul>
</div><div class="column" style="width:35%;">
<p><img src="./images/home_box3.png" class="img-fluid" width="500"></p>
</div>
</div>
</section>
<section id="example-strong-heart-study-22" class="level2">
<h2 class="anchored" data-anchor-id="example-strong-heart-study-22">Example: Strong Heart Study (2/2)</h2>
<p>There is a total of 1664 American Indians in the dataset, with the following distribution of folks with diabetes and glucose tolerance:</p>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#shs_data = read.csv(file = here("./data/SHS_data.csv"))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>SHS <span class="ot">=</span> <span class="fu">tibble</span>(<span class="at">Diabetes =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Not diabetic"</span>, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">1338</span>), </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">rep</span>(<span class="st">"Diabetic"</span>, <span class="dv">326</span>)),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">Glucose =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Normal"</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">1004</span>),<span class="co">#Not diabetic</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rep</span>(<span class="st">"Impaired"</span>, <span class="dv">334</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rep</span>(<span class="st">"Normal"</span>, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>              <span class="dv">128</span>), <span class="co">#Diabetic</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">rep</span>(<span class="st">"Impaired"</span>, <span class="dv">198</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell">
<details class="code-fold">
<summary>Displaying the contingency table in R</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>SHS <span class="sc">%&gt;%</span> <span class="fu">tabyl</span>(Glucose, Diabetes) <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="fu">c</span>(<span class="st">"row"</span>, <span class="st">"col"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_stubhead</span>(<span class="at">label =</span> <span class="st">"Glucose Impairment"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_spanner</span>(<span class="at">label =</span> <span class="st">"Diabetes"</span>, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">columns =</span> <span class="fu">c</span>(<span class="st">"Not diabetic"</span>, <span class="st">"Diabetic"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">45</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tmfqhedkep" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tmfqhedkep table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tmfqhedkep thead, #tmfqhedkep tbody, #tmfqhedkep tfoot, #tmfqhedkep tr, #tmfqhedkep td, #tmfqhedkep th {
  border-style: none;
}

#tmfqhedkep p {
  margin: 0;
  padding: 0;
}

#tmfqhedkep .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 45px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tmfqhedkep .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tmfqhedkep .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tmfqhedkep .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tmfqhedkep .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tmfqhedkep .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tmfqhedkep .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tmfqhedkep .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tmfqhedkep .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tmfqhedkep .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tmfqhedkep .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tmfqhedkep .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tmfqhedkep .gt_spanner_row {
  border-bottom-style: hidden;
}

#tmfqhedkep .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tmfqhedkep .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tmfqhedkep .gt_from_md > :first-child {
  margin-top: 0;
}

#tmfqhedkep .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tmfqhedkep .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tmfqhedkep .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tmfqhedkep .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tmfqhedkep .gt_row_group_first td {
  border-top-width: 2px;
}

#tmfqhedkep .gt_row_group_first th {
  border-top-width: 2px;
}

#tmfqhedkep .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmfqhedkep .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tmfqhedkep .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tmfqhedkep .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tmfqhedkep .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmfqhedkep .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tmfqhedkep .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tmfqhedkep .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tmfqhedkep .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tmfqhedkep .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tmfqhedkep .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmfqhedkep .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tmfqhedkep .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tmfqhedkep .gt_left {
  text-align: left;
}

#tmfqhedkep .gt_center {
  text-align: center;
}

#tmfqhedkep .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tmfqhedkep .gt_font_normal {
  font-weight: normal;
}

#tmfqhedkep .gt_font_bold {
  font-weight: bold;
}

#tmfqhedkep .gt_font_italic {
  font-style: italic;
}

#tmfqhedkep .gt_super {
  font-size: 65%;
}

#tmfqhedkep .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tmfqhedkep .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tmfqhedkep .gt_indent_1 {
  text-indent: 5px;
}

#tmfqhedkep .gt_indent_2 {
  text-indent: 10px;
}

#tmfqhedkep .gt_indent_3 {
  text-indent: 15px;
}

#tmfqhedkep .gt_indent_4 {
  text-indent: 20px;
}

#tmfqhedkep .gt_indent_5 {
  text-indent: 25px;
}

#tmfqhedkep .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tmfqhedkep div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Glucose" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Glucose</th>
<th colspan="2" id="Diabetes" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Diabetes
</div></th>
<th rowspan="2" id="Total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Total</th>
</tr>
<tr class="gt_col_headings even">
<th id="Not-diabetic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Not diabetic</th>
<th id="Diabetic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Diabetic</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Glucose">Impaired</td>
<td class="gt_row gt_right" headers="Not diabetic">334</td>
<td class="gt_row gt_right" headers="Diabetic">198</td>
<td class="gt_row gt_right" headers="Total">532</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Glucose">Normal</td>
<td class="gt_row gt_right" headers="Not diabetic">1004</td>
<td class="gt_row gt_right" headers="Diabetic">128</td>
<td class="gt_row gt_right" headers="Total">1132</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Glucose">Total</td>
<td class="gt_row gt_right" headers="Not diabetic">1338</td>
<td class="gt_row gt_right" headers="Diabetic">326</td>
<td class="gt_row gt_right" headers="Total">1664</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</div>
</section>
<section id="section-2" class="level2">
<h2 class="anchored" data-anchor-id="section-2"></h2>
<div class="example">
<div class="ex-title">
<p>Strong Heart Study</p>
</div>
<div class="ex-cont">
<p>What is the difference in proportions for American Indians that have diabetes comparing individuals with normal vs.&nbsp;impaired glucose?</p>
</div>
</div>
<p><strong>Needed steps:</strong></p>
<ol type="1">
<li>Estimate the difference in proportions</li>
<li>Check that each cell has at least 10 individuals</li>
<li>Construct 95% confidence interval</li>
<li>Write interpretation of estimate</li>
</ol>
</section>
<section id="section-3" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="section-3"></h2>
<div class="example">
<div class="ex-title">
<p>Strong Heart Study</p>
</div>
<div class="ex-cont">
<p>What is the difference in proportions for American Indians that have diabetes comparing individuals with normal vs.&nbsp;impaired glucose?</p>
</div>
</div>
<div class="columns">
<div class="column">
<div class="cell">
<div class="cell-output-display">
<div id="oczgenwibe" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oczgenwibe table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oczgenwibe thead, #oczgenwibe tbody, #oczgenwibe tfoot, #oczgenwibe tr, #oczgenwibe td, #oczgenwibe th {
  border-style: none;
}

#oczgenwibe p {
  margin: 0;
  padding: 0;
}

#oczgenwibe .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 28px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oczgenwibe .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oczgenwibe .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oczgenwibe .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oczgenwibe .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oczgenwibe .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oczgenwibe .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oczgenwibe .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oczgenwibe .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oczgenwibe .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oczgenwibe .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oczgenwibe .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oczgenwibe .gt_spanner_row {
  border-bottom-style: hidden;
}

#oczgenwibe .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oczgenwibe .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oczgenwibe .gt_from_md > :first-child {
  margin-top: 0;
}

#oczgenwibe .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oczgenwibe .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oczgenwibe .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oczgenwibe .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oczgenwibe .gt_row_group_first td {
  border-top-width: 2px;
}

#oczgenwibe .gt_row_group_first th {
  border-top-width: 2px;
}

#oczgenwibe .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oczgenwibe .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oczgenwibe .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oczgenwibe .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oczgenwibe .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oczgenwibe .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oczgenwibe .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oczgenwibe .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oczgenwibe .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oczgenwibe .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oczgenwibe .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oczgenwibe .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oczgenwibe .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oczgenwibe .gt_left {
  text-align: left;
}

#oczgenwibe .gt_center {
  text-align: center;
}

#oczgenwibe .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oczgenwibe .gt_font_normal {
  font-weight: normal;
}

#oczgenwibe .gt_font_bold {
  font-weight: bold;
}

#oczgenwibe .gt_font_italic {
  font-style: italic;
}

#oczgenwibe .gt_super {
  font-size: 65%;
}

#oczgenwibe .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oczgenwibe .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oczgenwibe .gt_indent_1 {
  text-indent: 5px;
}

#oczgenwibe .gt_indent_2 {
  text-indent: 10px;
}

#oczgenwibe .gt_indent_3 {
  text-indent: 15px;
}

#oczgenwibe .gt_indent_4 {
  text-indent: 20px;
}

#oczgenwibe .gt_indent_5 {
  text-indent: 25px;
}

#oczgenwibe .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#oczgenwibe div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings gt_spanner_row header">
<th rowspan="2" id="Glucose" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Glucose</th>
<th colspan="2" id="Diabetes" class="gt_center gt_columns_top_border gt_column_spanner_outer" data-quarto-table-cell-role="th" scope="colgroup"><div class="gt_column_spanner">
Diabetes
</div></th>
<th rowspan="2" id="Total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Total</th>
</tr>
<tr class="gt_col_headings even">
<th id="Not-diabetic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Not diabetic</th>
<th id="Diabetic" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Diabetic</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Glucose">Impaired</td>
<td class="gt_row gt_right" headers="Not diabetic">334</td>
<td class="gt_row gt_right" headers="Diabetic">198</td>
<td class="gt_row gt_right" headers="Total">532</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Glucose">Normal</td>
<td class="gt_row gt_right" headers="Not diabetic">1004</td>
<td class="gt_row gt_right" headers="Diabetic">128</td>
<td class="gt_row gt_right" headers="Total">1132</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Glucose">Total</td>
<td class="gt_row gt_right" headers="Not diabetic">1338</td>
<td class="gt_row gt_right" headers="Diabetic">326</td>
<td class="gt_row gt_right" headers="Total">1664</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ol type="1">
<li><p>Estimate the difference in proportions <span class="math display">\[ \widehat{p}_1 -\widehat{p}_2 = \dfrac{198}{532} - \dfrac{128}{1132} = 0.2591\]</span></p></li>
<li><p>Check that each cell has at least 10 individuals</p></li>
</ol>
</div><div class="column">
<ol start="3" type="1">
<li>Construct 95% confidence interval</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="at">x =</span> <span class="fu">table</span>(SHS<span class="sc">$</span>Glucose, SHS<span class="sc">$</span>Diabetes), </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">correct =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    2-sample test for equality of proportions with continuity correction

data:  table(SHS$Glucose, SHS$Diabetes)
X-squared = 152.6, df = 1, p-value &lt; 2.2e-16
alternative hypothesis: two.sided
95 percent confidence interval:
 0.2126963 0.3055162
sample estimates:
   prop 1    prop 2 
0.3721805 0.1130742 </code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Write interpretation of <strong>estimate</strong></li>
</ol>
<p>The estimated difference in proportion of diabetic American Indians comparing is 0.259 (95% CI: 0.213, 0.306).</p>
<p>Additional interpretation of CI: We are 95% confident that the difference in (population) proportions of American Indians who have normal glucose tolerance and impaired glucose tolerance that developed diabetes is between 0.213 and 0.306.</p>
</div>
</div>
</section>
<section id="mcnemars-test" class="level2">
<h2 class="anchored" data-anchor-id="mcnemars-test">McNemar‚Äôs Test</h2>
<ul>
<li>McNemar‚Äôs test should be used if data is from a matched pairs study</li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>What is a matched-pairs study?</p>
<ul>
<li>Participants are paired based on key characteristics</li>
<li>Each participant within a pair will be assigned to different treatment groups</li>
</ul></li>
<li><p>Categorical test that is parallel to the ‚Äúpaired t-test‚Äù</p></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>R packages and functions</p>
<ul>
<li>Normal approximation: <code>mcnemar.test()</code> in built-in <code>stats</code> package</li>
<li>Exact test: <code>mcnemar.exact()</code> in <code>exact2x2</code> package</li>
</ul></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><strong>If you would like more information of McNemar‚Äôs test, please see Rosner TB: 10.4 and 10.5: Paired Samples</strong></li>
</ul>
</section>
<section id="summary-so-far" class="level2">
<h2 class="anchored" data-anchor-id="summary-so-far">Summary so far</h2>
<ul>
<li>Introduced categorical data as the response in analysis</li>
<li>Reviewed an important distribution (Binomial distribution) for categorical data analysis</li>
<li>Estimated a single proportion from a sample with its confidence interval</li>
<li>Estimated a difference in proportions from a sample with its confidence interval</li>
</ul>
<p>&nbsp; &nbsp;</p>
<ul>
<li><p>Can we expand this to ask a more general question about association between a response and explanatory variable?</p>
<ul>
<li>What if there is more than 2 categories for either variable?</li>
</ul></li>
</ul>
</section>
</section>
<section id="learning-objectives-5" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Recognize the motivation for and focus of our course (categorical responses)</p></li>
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
<li><p>Determine if a single proportion differs from a population value</p></li>
<li><p>Determine if two proportions differ from each other</p></li>
</ol>
<div class="lob">
<ol start="5" type="1">
<li>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</li>
</ol>
</div>
<ol start="6" type="1">
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
<li><p>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</p></li>
</ol>
<section id="contingency-tables-r-x-c" class="level2">
<h2 class="anchored" data-anchor-id="contingency-tables-r-x-c">Contingency Tables (R x C)</h2>
<ul>
<li><p>R X C contingency tables</p>
<ul>
<li><p>Contains information for two discrete variables: one has R categories and the other has C categories.</p></li>
<li><p>Refers to the number of rows (R) and number of columns (C) in the table</p></li>
</ul></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>For two proportions: focused on 2 X 2 contingency tables</p>
<ul>
<li>R = 2, C = 2</li>
</ul></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>Expand our contingency tables to variables with 2 or more categories</p>
<ul>
<li>Categories can be ordinal or nominal</li>
</ul></li>
</ul>
</section>
<section id="contingency-table-example" class="level2">
<h2 class="anchored" data-anchor-id="contingency-table-example">Contingency Table: Example</h2>
<p>Let‚Äôs say we are interested in learning the association between the development of breast cancer and age at first birth. Our first step is typically to present the observed data:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/Conting_tab_ex.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="511"></p>
</figure>
</div>
<ul>
<li>This is a 2 x 5 contingency table</li>
</ul>
</section>
<section id="test-associationtrend-of-r-x-c-contingency-table" class="level2">
<h2 class="anchored" data-anchor-id="test-associationtrend-of-r-x-c-contingency-table">Test Association/Trend of R X C Contingency Table</h2>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:46%;">
<p>If <span style="color:#4472C4; font-weight: bold;">both variables are nominal</span>, a <span style="color:#4472C4; font-style: italic;">test of general association</span> will be sufficient</p>
<ul>
<li><p>Test of general association is the same regardless of R and C</p></li>
<li><p>Test used for 2x2 contingency table same as 5x3 contingency table</p></li>
<li><p>We will cover:</p>
<ul>
<li>Chi-squared test</li>
<li>Fisher Exact test</li>
</ul></li>
</ul>
</div><div class="column" style="width:6%;">

</div><div class="column" style="width:48%;">
<p>If <span style="color:#70AD47; font-weight: bold;">one or both variables are ordinal</span>, a <span style="color:#70AD47; font-style: italic;">test of trend</span> may be of interest</p>
<ul>
<li><p>Treats ordinal variables as quantitative rather than qualitative (nominal scale)</p></li>
<li><p>Test of trend has greater power than the test of general association</p></li>
<li><p>We will cover:</p>
<ul>
<li>Cochran-Armitage test</li>
<li>Mantel-Haenszel test</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="poll-everywhere-question-4" class="level2">
<h2 class="anchored" data-anchor-id="poll-everywhere-question-4">Poll Everywhere Question 4</h2>
</section>
<section id="test-of-general-association" class="level2">
<h2 class="anchored" data-anchor-id="test-of-general-association">Test of General Association</h2>
<ul>
<li><strong>General research question:</strong> Are two variables (both categorical, nominal) associated with each other?</li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>Translated to a hypothesis test:</p>
<ul>
<li><span class="math inline">\(H_0\)</span> : There is no association between the two variables / The variables are independent</li>
<li><span class="math inline">\(H_1\)</span> : There is an association between the two variables / The variables are not independent</li>
</ul></li>
</ul>
<p>&nbsp; &nbsp;</p>
<ul>
<li><p>We have two options for testing general association:</p>
<ol type="1">
<li>Chi-squared test</li>
<li>Fisher‚Äôs Exact test</li>
</ol></li>
</ul>
</section>
<section id="test-of-general-association-shs-example" class="level2">
<h2 class="anchored" data-anchor-id="test-of-general-association-shs-example">Test of General Association: SHS Example</h2>
<ul>
<li><p><strong>Main question:</strong> Do American Indians with impaired glucose tolerance have a different incidence of diabetes?</p>
<ul>
<li>Is glucose tolerance associated with diabetes incidence among American Indians?</li>
</ul></li>
<li><p>We have two variables, and both variables have two nominal categories</p>
<ul>
<li>Diabetes outcome: Not diabetic and Diabetic</li>
<li>Glucose tolerance: Normal or Impaired</li>
</ul></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>Answer research question with a test of general association</p></li>
<li><p>Hypothesis:</p>
<ul>
<li><span class="math inline">\(H_0\)</span> : There is no association between glucose tolerance and diabetes / Glucose tolerance and diabetes are independent</li>
<li><span class="math inline">\(H_1\)</span> : There is an association between glucose tolerance and diabetes / Glucose tolerance and diabetes are not independent</li>
</ul></li>
</ul>
</section>
</section>
<section id="learning-objectives-6" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Recognize the motivation for and focus of our course (categorical responses)</p></li>
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
<li><p>Determine if a single proportion differs from a population value</p></li>
<li><p>Determine if two proportions differ from each other</p></li>
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
</ol>
<div class="lob">
<ol start="6" type="1">
<li>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</li>
</ol>
</div>
<ol start="7" type="1">
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
<li><p>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</p></li>
</ol>
<section id="chi-squared-test" class="level2">
<h2 class="anchored" data-anchor-id="chi-squared-test">Chi-squared test</h2>
<ul>
<li>Test to see how likely is it that we observe our data given the null hypothesis (no association)</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>We use the null to calculate the expected cell counts and compare them to the observed cell counts</li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>Requirements to conduct Chi-squared test (expected cell counts)</p>
<ul>
<li><p>For 2 x 2 contingency table:</p>
<ul>
<li>No expected cell counts should be less than 10</li>
</ul></li>
<li><p>For contingency table with 3x2, 3x3, 4x4, etc.:</p>
<ul>
<li>No more than 20% of expected cell counts are less than 5</li>
<li>No expected cell counts are less than 1</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="chi-squared-test-process" class="level2">
<h2 class="anchored" data-anchor-id="chi-squared-test-process">Chi-squared test: Process</h2>
<ol type="1">
<li><p>Check that the <span style="color:#70AD47"><strong>expected cell counts</strong></span> threshold is met</p></li>
<li><p>Set the <span style="color:#70AD47"><strong>level of significance</strong></span> <span class="math inline">\(\alpha\)</span></p></li>
<li><p>Specify the <span style="color:#70AD47"><strong>null</strong></span> ( <span class="math inline">\(H_0\)</span> ) and <span style="color:#70AD47"><strong>alternative</strong></span> ( <span class="math inline">\(H_A\)</span> ) <span style="color:#70AD47"><strong>hypotheses</strong></span></p>
<ul>
<li>In symbols</li>
<li>In words</li>
<li>Alternative: one- or two-sided?</li>
</ul></li>
<li><p>Calculate the <span style="color:#70AD47"><strong>test statistic</strong></span> and <span style="color:#70AD47"><strong>p-value</strong></span> for Chi-squared test in R</p>
<ul>
<li>We will not discuss the test statistic‚Äôs equation</li>
</ul></li>
<li><p>Write a <span style="color:#70AD47"><strong>conclusion</strong></span> to the hypothesis test</p>
<ul>
<li>Do we reject or fail to reject <span class="math inline">\(H_0\)</span>?</li>
<li>Write a conclusion in the context of the problem</li>
</ul></li>
</ol>
</section>
<section id="chi-squared-test-expected-cell-counts" class="level2">
<h2 class="anchored" data-anchor-id="chi-squared-test-expected-cell-counts">Chi-squared test: Expected Cell Counts</h2>
<ul>
<li>Is the sample size big enough for the chi-square test to be adequate? What are the expected cell counts?</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>If you want an explanation of how to calculate by hand, please see Vu and Harringtion TB (section 8.3.1, page 405)</li>
</ul>
<p>&nbsp;</p>
<ul>
<li>Too time consuming for this class, but R does it quickly using the <code>expected()</code> function in the <code>epitools</code> package</li>
</ul>
</section>
<section id="chi-squared-test-expected-cell-counts-1" class="level2">
<h2 class="anchored" data-anchor-id="chi-squared-test-expected-cell-counts-1">Chi-squared test: Expected Cell Counts</h2>
<ul>
<li>In the Strong Heart Study‚Ä¶</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>SHS_table <span class="ot">=</span> <span class="fu">table</span>(SHS<span class="sc">$</span>Glucose, SHS<span class="sc">$</span>Diabetes)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>SHS_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           Diabetic Not diabetic
  Impaired      198          334
  Normal        128         1004</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(epitools)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">expected</span>(SHS_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           Diabetic Not diabetic
  Impaired  104.226      427.774
  Normal    221.774      910.226</code></pre>
</div>
</div>
<p>&nbsp;</p>
<div class="columns">
<div class="column" style="width:15%;">

</div><div class="column" style="width:28%;">
<div class="hl3">
<p>All expected counts &gt; 5</p>
</div>
</div><div class="column" style="width:38%;">

</div>
</div>
</section>
<section id="chi-squared-test-shs-example" class="level2">
<h2 class="anchored" data-anchor-id="chi-squared-test-shs-example">Chi-squared test: SHS Example</h2>
<div class="columns">
<div class="column">
<ol type="1">
<li>Check expected cell counts threshold</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expected</span>(SHS_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           Diabetic Not diabetic
  Impaired  104.226      427.774
  Normal    221.774      910.226</code></pre>
</div>
</div>
<p>All expected cells are greater than 5.</p>
<ol start="2" type="1">
<li><p><span class="math inline">\(\alpha = 0.05\)</span></p></li>
<li><p>Hypothesis test:</p>
<ul>
<li><span class="math inline">\(H_0\)</span> : There is no association between glucose tolerance and diabetes</li>
<li><span class="math inline">\(H_1\)</span> : There is an association between glucose tolerance and diabetes</li>
</ul></li>
</ol>
</div><div class="column">
<ol start="4" type="1">
<li>Calculate the test statistic and p-value for Chi-squared test in R</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chisq.test</span>(<span class="at">x =</span> SHS_table, <span class="at">correct =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test with Yates' continuity correction

data:  SHS_table
X-squared = 152.6, df = 1, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Conclusion to the hypothesis test</li>
</ol>
<p>We reject the null hypothesis that glucose tolerance and diabetes are not associated (<span class="math inline">\(p&lt;2.2\cdot10^{-16}\)</span>). There is sufficient evidence that glucose tolerance and diabetes incidence are associated among American Indians.</p>
</div>
</div>
</section>
</section>
<section id="learning-objectives-7" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Recognize the motivation for and focus of our course (categorical responses)</p></li>
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
<li><p>Determine if a single proportion differs from a population value</p></li>
<li><p>Determine if two proportions differ from each other</p></li>
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
</ol>
<div class="lob">
<ol start="7" type="1">
<li>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</li>
</ol>
</div>
<ol start="8" type="1">
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
<li><p>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</p></li>
</ol>
<section id="fishers-exact-test" class="level2">
<h2 class="anchored" data-anchor-id="fishers-exact-test">Fisher‚Äôs Exact Test</h2>
<ul>
<li>Only necessary when expected counts in one or more cells is less than 5</li>
<li>Given row and column totals fixed, computes exact probability that we observe our data or more extreme data</li>
<li>Consider a general 2 x 2 table:</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/fisher_tab.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<ul>
<li>The exact probability of observing a table with cells (a, b, c, d) can be computed based on the hypergeometric distribution</li>
</ul>
<p><span class="math display">\[P(a, b, c, d) = \dfrac{(a+b)!\cdot(c+d)!\cdot(a+c)!\cdot(b+d)!}{n!\cdot a!\cdot b!\cdot c!\cdot d!}\]</span></p>
<ul>
<li>Numerator is fixed and denominator changes</li>
</ul>
</section>
<section id="fishers-exact-test-process" class="level2">
<h2 class="anchored" data-anchor-id="fishers-exact-test-process">Fisher‚Äôs Exact test: Process</h2>
<ol type="1">
<li><p>Check the <span style="color:#70AD47"><strong>expected cell counts</strong></span></p></li>
<li><p>Set the <span style="color:#70AD47"><strong>level of significance</strong></span> <span class="math inline">\(\alpha\)</span></p></li>
<li><p>Specify the <span style="color:#70AD47"><strong>null</strong></span> ( <span class="math inline">\(H_0\)</span> ) and <span style="color:#70AD47"><strong>alternative</strong></span> ( <span class="math inline">\(H_A\)</span> ) <span style="color:#70AD47"><strong>hypotheses</strong></span></p>
<ul>
<li>In symbols</li>
<li>In words</li>
<li>Alternative: one- or two-sided?</li>
</ul></li>
<li><p>Calculate the <span style="color:#70AD47"><strong>test statistic</strong></span> and <span style="color:#70AD47"><strong>p-value</strong></span> for Fisher Exact test in R</p>
<ul>
<li>We will not discuss the test statistic‚Äôs equation</li>
</ul></li>
<li><p>Write a <span style="color:#70AD47"><strong>conclusion</strong></span> to the hypothesis test</p>
<ul>
<li>Do we reject or fail to reject <span class="math inline">\(H_0\)</span>?</li>
<li>Write a conclusion in the context of the problem</li>
</ul></li>
</ol>
</section>
<section id="fishers-exact-test-shs-example-not-appropriate-use-of-fishers-exact" class="level2">
<h2 class="anchored" data-anchor-id="fishers-exact-test-shs-example-not-appropriate-use-of-fishers-exact">Fisher‚Äôs Exact test: SHS Example (not appropriate use of Fisher‚Äôs Exact)</h2>
<div class="columns">
<div class="column">
<ol type="1">
<li>Check expected cell counts threshold</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">expected</span>(SHS_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          
           Diabetic Not diabetic
  Impaired  104.226      427.774
  Normal    221.774      910.226</code></pre>
</div>
</div>
<p>We‚Äôre going to pretend they are less than 5.</p>
<ol start="2" type="1">
<li><p><span class="math inline">\(\alpha = 0.05\)</span></p></li>
<li><p>Hypothesis test:</p>
<ul>
<li><span class="math inline">\(H_0\)</span> : There is no association between glucose tolerance and diabetes</li>
<li><span class="math inline">\(H_1\)</span> : There is an association between glucose tolerance and diabetes</li>
</ul></li>
</ol>
</div><div class="column">
<ol start="4" type="1">
<li>Calculate the test statistic and p-value for Chi-squared test in R</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fisher.test</span>(<span class="at">x =</span> SHS_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  SHS_table
p-value &lt; 2.2e-16
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
 3.576595 6.048639
sample estimates:
odds ratio 
  4.644825 </code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Conclusion to the hypothesis test</li>
</ol>
<p>We reject the null hypothesis that glucose tolerance and diabetes are not associated (<span class="math inline">\(p&lt;2.2\cdot10^{-16}\)</span>). There is sufficient evidence that glucose tolerance and diabetes incidence are associated among American Indians.</p>
</div>
</div>
</section>
</section>
<section id="learning-objectives-8" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Recognize the motivation for and focus of our course (categorical responses)</p></li>
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
<li><p>Determine if a single proportion differs from a population value</p></li>
<li><p>Determine if two proportions differ from each other</p></li>
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
</ol>
<div class="lob">
<ol start="8" type="1">
<li>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</li>
</ol>
</div>
<ol start="9" type="1">
<li>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</li>
</ol>
<section id="test-of-trend" class="level2">
<h2 class="anchored" data-anchor-id="test-of-trend">Test of Trend</h2>
<ul>
<li><p>If <span style="color:#70AD47; font-weight: bold;">one or both variables are ordinal</span>, a <span style="color:#70AD47; font-style: italic;">test of trend</span> may be of interest</p>
<ul>
<li>Treats ordinal variables as quantitative rather than qualitative (nominal scale)</li>
<li>Test of trend has greater power than the test of general association</li>
<li>You can use a test of general association for non-ordinal variables</li>
</ul></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>Two tests of trend that we we learn:</p>
<ul>
<li><p><strong>Cochran-Armitage test</strong></p>
<ul>
<li>Tests association between a <em>binary</em> response and an <em>ordinal</em> explanatory variable</li>
</ul></li>
<li><p><strong>Mantel-Haenszel test</strong></p>
<ul>
<li>Test association between an <em>ordinal</em> response and an <em>ordinal</em> explanatory variable</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="cochran-armitage-test" class="level2">
<h2 class="anchored" data-anchor-id="cochran-armitage-test">Cochran-Armitage test</h2>
<ul>
<li>Cochran-Armitage test for trend will determine if there is association between a <span style="color:#70AD47; font-weight: bold;">binary response variable</span> and an <span style="color:#70AD47; font-weight: bold;">ordinal variable with 3 or more categories</span></li>
</ul>
<p>&nbsp;</p>
<ul>
<li><p>It will test the trend of the proportions over the ordinal variable</p>
<ul>
<li>Answers the question: Does the proportion of people with a ‚Äúsuccessful‚Äù outcome increase as the ordinal explanatory variable increases?</li>
</ul></li>
</ul>
<p>&nbsp;</p>
<ul>
<li>Cochran-Armitage test for trend is only suitable for 2 x C contingency tables</li>
</ul>
</section>
<section id="cochran-armitage-test-hypothesis-test" class="level2">
<h2 class="anchored" data-anchor-id="cochran-armitage-test-hypothesis-test">Cochran-Armitage test: Hypothesis Test</h2>
<div class="columns">
<div class="column">
<div class="definition">
<div class="def-title">
<p>Null Hypothesis (<span class="math inline">\(H_0\)</span>)</p>
</div>
<div class="def-cont">
<p>The proportions of successes are the same across all C ordinal values of the explanatory variable. <span class="math display">\[p_1 = p_2 = ... = p_C\]</span></p>
</div>
</div>
</div><div class="column">
<div class="proof1">
<div class="proof-title">
<p>Alternative Hypothesis (<span class="math inline">\(H_1\)</span>)</p>
</div>
<div class="proof-cont">
<p>The proportions of successes tend to increase as ordinal value of the explanatory variable increases</p>
<p><span class="math display">\[p_1 \leq p_2 \leq ... \leq p_C\]</span></p>
<p>OR</p>
<p>The proportions of successes tend to decrease as ordinal value of the explanatory variable increases</p>
<p><span class="math display">\[p_1 \geq p_2 \geq ... \geq p_C\]</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="cochran-armitage-test-process" class="level2">
<h2 class="anchored" data-anchor-id="cochran-armitage-test-process">Cochran-Armitage test: Process</h2>
<ol type="1">
<li><p>Set the <span style="color:#70AD47"><strong>level of significance</strong></span> <span class="math inline">\(\alpha\)</span></p></li>
<li><p>Specify the <span style="color:#70AD47"><strong>null</strong></span> ( <span class="math inline">\(H_0\)</span> ) and <span style="color:#70AD47"><strong>alternative</strong></span> ( <span class="math inline">\(H_A\)</span> ) <span style="color:#70AD47"><strong>hypotheses</strong></span></p>
<ul>
<li>In symbols</li>
<li>In words</li>
<li>Alternative: one- or two-sided?</li>
</ul></li>
<li><p>Calculate the <span style="color:#70AD47"><strong>test statistic</strong></span> and <span style="color:#70AD47"><strong>p-value</strong></span> for Cochran-Armitage test in R</p>
<ul>
<li>We will not discuss the test statistic‚Äôs equation</li>
<li>Just know it follows a Normal distribution</li>
</ul></li>
<li><p>Write a <span style="color:#70AD47"><strong>conclusion</strong></span> to the hypothesis test</p>
<ul>
<li>Do we reject or fail to reject <span class="math inline">\(H_0\)</span>?</li>
<li>Write a conclusion in the context of the problem</li>
</ul></li>
</ol>
</section>
<section id="cochran-armitage-test-example-13" class="level2">
<h2 class="anchored" data-anchor-id="cochran-armitage-test-example-13">Cochran-Armitage test: Example (1/3)</h2>
<p>We are interested in learning the association between the development of breast cancer and age at first birth among people who have given birth</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/Cancer_conting.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>&nbsp; &nbsp;</p>
</section>
<section id="cochran-armitage-test-example-23" class="level2">
<h2 class="anchored" data-anchor-id="cochran-armitage-test-example-23">Cochran-Armitage test: Example (2/3)</h2>
<ul>
<li>Before we go into the hypothesis test procedure, we need to construct the contingency table in R</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>Cancer <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">320</span>, <span class="dv">1206</span>, <span class="dv">1011</span>, <span class="dv">463</span>, <span class="dv">220</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>No_Cancer <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1422</span>, <span class="dv">4432</span>, <span class="dv">2893</span>, <span class="dv">1092</span>, <span class="dv">406</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>bscancer <span class="ot">=</span> <span class="fu">matrix</span> (<span class="fu">c</span>(Cancer, No_Cancer), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> T)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(bscancer) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Cancer"</span>,<span class="st">"No Cancer"</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(bscancer) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"&lt;20"</span>,<span class="st">"20-24"</span>,<span class="st">"25-29"</span>,<span class="st">"30-34"</span>,<span class="st">"&gt;=35"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>bscancer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           &lt;20 20-24 25-29 30-34 &gt;=35
Cancer     320  1206  1011   463  220
No Cancer 1422  4432  2893  1092  406</code></pre>
</div>
</div>
<ul>
<li>It does not need to be pretty to use in function</li>
</ul>
</section>
<section id="cochran-armitage-test-example-33" class="level2">
<h2 class="anchored" data-anchor-id="cochran-armitage-test-example-33">Cochran-Armitage test: Example (3/3)</h2>
<div class="columns">
<div class="column">
<ol type="1">
<li><p><span class="math inline">\(\alpha = 0.05\)</span></p></li>
<li><p>Hypothesis test:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: The proportions of breast cancer are the same for all age levels of first birth. <span class="math display">\[p_1 = p_2 = ... = p_5\]</span></li>
<li><span class="math inline">\(H_1\)</span>: The proportions of breast cancer tends to increase as level of age of first birth increases</li>
</ul></li>
</ol>
<p><span class="math display">\[p_1 \leq p_2 \leq ... \leq p_5\]</span></p>
</div><div class="column">
<ol start="3" type="1">
<li>Calculate the test statistic and p-value for Cochran-Armitage test in R</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">CochranArmitageTest</span>(bscancer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Cochran-Armitage test for trend

data:  bscancer
Z = 11.358, dim = 5, p-value &lt; 2.2e-16
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Conclusion to the hypothesis test</li>
</ol>
<p>We reject the null hypothesis that proportions of breast cancer are the same for all age levels of first birth (<span class="math inline">\(p&lt;2.2\cdot10^{-16}\)</span>). There is sufficient evidence that the proportion of of breast cancer increase as the the age at first birth increases.</p>
</div>
</div>
</section>
</section>
<section id="learning-objectives-9" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Recognize the motivation for and focus of our course (categorical responses)</p></li>
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
<li><p>Determine if a single proportion differs from a population value</p></li>
<li><p>Determine if two proportions differ from each other</p></li>
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
</ol>
<div class="lob">
<ol start="9" type="1">
<li>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</li>
</ol>
</div>
<section id="mantel-haenszel-test" class="level2">
<h2 class="anchored" data-anchor-id="mantel-haenszel-test">Mantel-Haenszel test</h2>
<ul>
<li><p>When both variables are ordinal, we can conduct Mantel-Haenszel test of trend for linear association</p></li>
<li><p>Mantel-Haenszel test for linear trend is suitable for any R x C contingency tables with two ordinal variables</p></li>
<li><p>Hypothesis test:</p></li>
</ul>
<div class="columns">
<div class="column">
<div class="definition">
<div class="def-title">
<p>Null Hypothesis (<span class="math inline">\(H_0\)</span>)</p>
</div>
<div class="def-cont">
<p>There is no correlation between the two variables <span class="math display">\[ \rho = 0\]</span></p>
</div>
</div>
</div><div class="column">
<div class="proof1">
<div class="proof-title">
<p>Alternative Hypothesis (<span class="math inline">\(H_1\)</span>)</p>
</div>
<div class="proof-cont">
<p>There is correlation between the two variables</p>
<p><span class="math display">\[ \rho \neq 0\]</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="mantel-haenszel-test-process" class="level2">
<h2 class="anchored" data-anchor-id="mantel-haenszel-test-process">Mantel-Haenszel test: Process</h2>
<ol type="1">
<li><p>Set the <span style="color:#70AD47"><strong>level of significance</strong></span> <span class="math inline">\(\alpha\)</span></p></li>
<li><p>Specify the <span style="color:#70AD47"><strong>null</strong></span> ( <span class="math inline">\(H_0\)</span> ) and <span style="color:#70AD47"><strong>alternative</strong></span> ( <span class="math inline">\(H_A\)</span> ) <span style="color:#70AD47"><strong>hypotheses</strong></span></p>
<ul>
<li>In symbols</li>
<li>In words</li>
<li>Alternative: one- or two-sided?</li>
</ul></li>
<li><p>Calculate the <span style="color:#70AD47"><strong>test statistic</strong></span> and <span style="color:#70AD47"><strong>p-value</strong></span> for Mantel-Haenszel test in R</p>
<ul>
<li>We will not discuss the test statistic‚Äôs equation</li>
</ul></li>
<li><p>Write a <span style="color:#70AD47"><strong>conclusion</strong></span> to the hypothesis test</p>
<ul>
<li>Do we reject or fail to reject <span class="math inline">\(H_0\)</span>?</li>
<li>Write a conclusion in the context of the problem</li>
</ul></li>
</ol>
</section>
<section id="mantel-haenszel-test-example-13" class="level2">
<h2 class="anchored" data-anchor-id="mantel-haenszel-test-example-13">Mantel-Haenszel test: Example (1/3)</h2>
<p>A water treatment company is studying water additives and investigating how they affect clothes washing (through measurements of abrasions, wearing, and color loss).</p>
<p>The treatments studies where no treatment (plain water), the standard treatment, and a double dose of the standard treatment, called super. Washability was measured as low, medium and high.</p>
<p>Are levels of washability associated with treatment?</p>
<p>&nbsp;</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./images/water_conting.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>&nbsp;</p>
</section>
<section id="mantel-haenszel-test-example-23" class="level2">
<h2 class="anchored" data-anchor-id="mantel-haenszel-test-example-23">Mantel-Haenszel test: Example (2/3)</h2>
<ul>
<li>Before we go into the hypothesis test procedure, we need to construct the contingency table in R</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>water <span class="ot">=</span> <span class="fu">matrix</span> (<span class="fu">c</span>(<span class="dv">27</span>, <span class="dv">14</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">17</span>, <span class="dv">26</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">50</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> T)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(water) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"plain"</span>,<span class="st">"standard"</span>,<span class="st">"super"</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(water) <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"medium"</span>,<span class="st">"high"</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>water</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         low medium high
plain     27     14    5
standard  10     17   26
super      5     12   50</code></pre>
</div>
</div>
<ul>
<li>It does not need to be pretty to use in function</li>
</ul>
</section>
<section id="mantel-haenszel-test-example-33" class="level2">
<h2 class="anchored" data-anchor-id="mantel-haenszel-test-example-33">Mantel-Haenszel test: Example (3/3)</h2>
<div class="columns">
<div class="column">
<ol type="1">
<li><p><span class="math inline">\(\alpha = 0.05\)</span></p></li>
<li><p>Hypothesis test:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: Water treatment and washability are not correlated. <span class="math display">\[ \rho = 0\]</span></li>
<li><span class="math inline">\(H_1\)</span>: Water treatment and washability are correlated.</li>
</ul></li>
</ol>
<p><span class="math display">\[ \rho \neq 0\]</span></p>
</div><div class="column">
<ol start="3" type="1">
<li>Calculate the test statistic and p-value for Mantel-Haenszel test in R</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">MHChisqTest</span>(water)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Mantel-Haenszel Chi-Square

data:  water
X-squared = 50.602, df = 1, p-value = 1.132e-12</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Conclusion to the hypothesis test</li>
</ol>
<p>We reject the null hypothesis that there is no correlation between washability and water treatment (<span class="math inline">\(p = 1.13 \cdot 10^{-12} &lt; 0.05\)</span>). There is sufficient evidence that level of water treatment is associated with washability.</p>
</div>
</div>
</section>
</section>
<section id="learning-objectives-10" class="level1">
<h1>Learning Objectives</h1>
<ol type="1">
<li><p>Recognize the motivation for and focus of our course (categorical responses)</p></li>
<li><p>Recall features of the Binomial distribution for categorical data analysis and utilize the normal approximation</p></li>
<li><p>Determine if a single proportion differs from a population value</p></li>
<li><p>Determine if two proportions differ from each other</p></li>
<li><p>Display data from two categorical variables, each with 2 or more categories, using R X C contingency tables</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Chi-squared test</p></li>
<li><p>Determine if a nominal response and nominal explanatory variable are associated with one another using the Fisher Exact test</p></li>
<li><p>Determine if a binary, nominal response and an ordinal explanatory variable are associated with one another using the Cochran-Armitage test</p></li>
<li><p>Determine if an ordinal response and ordinal explanatory variable are associated with one another using the Mantel-Haenszel test</p></li>
</ol>
<section id="more-resources" class="level2">
<h2 class="anchored" data-anchor-id="more-resources">More resources</h2>
<ul>
<li><p><a href="https://niederhausen.github.io/BSTA_511_F23/weeks/week_07.html">For a refresher or review</a> of one proportion and differences in proportions</p>
<ul>
<li><p>And their power calculations</p></li>
<li><p>From Meike‚Äôs BSTA 511 course (see Day 12!)</p></li>
</ul></li>
<li><p><a href="https://niederhausen.github.io/BSTA_511_F23/weeks/week_08.html">For a refresher or review</a> of Chi-squared test or Fisher‚Äôs Exact test</p>
<ul>
<li>From Meike‚Äôs BSTA 511 course (see Day 13!)</li>
</ul></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>