<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Missing Data – Categorical Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-62d5ecfa613c5c5644cabfb02a2f4c65.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-sm " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/Bsta513.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Categorical Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../schedule.html"> 
<span class="menu-text">Schedule</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../instructors.html"> 
<span class="menu-text">Instructors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../homeworks.html"> 
<span class="menu-text">Homework</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../project.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#citizenship-had-missing-data-that-was-not-coded-as-na" id="toc-citizenship-had-missing-data-that-was-not-coded-as-na" class="nav-link active" data-scroll-target="#citizenship-had-missing-data-that-was-not-coded-as-na">Citizenship had missing data that was not coded as <code>NA</code></a></li>
  <li><a href="#look-at-the-missing-data-pattern" id="toc-look-at-the-missing-data-pattern" class="nav-link" data-scroll-target="#look-at-the-missing-data-pattern">Look at the missing data pattern</a></li>
  <li><a href="#check-the-distributions-of-the-variables-from-the-observed-vs.-missing-data" id="toc-check-the-distributions-of-the-variables-from-the-observed-vs.-missing-data" class="nav-link" data-scroll-target="#check-the-distributions-of-the-variables-from-the-observed-vs.-missing-data">Check the distributions of the variables from the observed vs.&nbsp;missing data</a></li>
  <li><a href="#use-mice-to-impute-data" id="toc-use-mice-to-impute-data" class="nav-link" data-scroll-target="#use-mice-to-impute-data">Use mice to impute data</a></li>
  <li><a href="#complete-data" id="toc-complete-data" class="nav-link" data-scroll-target="#complete-data">Complete data</a></li>
  <li><a href="#see-how-the-imputed-values-look-within-the-observed-values" id="toc-see-how-the-imputed-values-look-within-the-observed-values" class="nav-link" data-scroll-target="#see-how-the-imputed-values-look-within-the-observed-values">See how the imputed values look within the observed values</a></li>
  <li><a href="#fit-regression-with-imputations" id="toc-fit-regression-with-imputations" class="nav-link" data-scroll-target="#fit-regression-with-imputations">Fit regression with imputations</a></li>
  <li><a href="#we-can-do-an-informal-sensitivity-analysis" id="toc-we-can-do-an-informal-sensitivity-analysis" class="nav-link" data-scroll-target="#we-can-do-an-informal-sensitivity-analysis">We can do an informal sensitivity analysis</a></li>
  <li><a href="#now-we-can-proceed-with-the-other-parts-of-lab-3" id="toc-now-we-can-proceed-with-the-other-parts-of-lab-3" class="nav-link" data-scroll-target="#now-we-can-proceed-with-the-other-parts-of-lab-3">Now we can proceed with the other parts of Lab 3</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Missing Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(naniar)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">here</span>(<span class="st">"project"</span>, <span class="st">"data"</span>, <span class="st">"wbns_data.rda"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>My variables:</p>
<ul>
<li><p>Outcome: food insecurity</p></li>
<li><p>Predictors:</p>
<ul>
<li>PPAGE: Age</li>
<li>LGBT: Gay or lesbian, bisexual, or transgender (re-coded)</li>
<li>XACSNET: Internet access</li>
<li>PARTNER: Living with a partner</li>
<li>FAMSIZE: Family size - field data and imputed</li>
<li>INSURED: Insured at time of survey</li>
<li>UNMETCARE_Y: Needed medical care but did not get it because could not afford it in past 12 months</li>
<li>PPP20197: Citizen</li>
<li>PPINCIMP: Household income</li>
<li>PPETHM: Race/ethnicity</li>
</ul></li>
</ul>
<p>You should only need to replace my dataset name with yours and my use of variable names with your project’s variables.</p>
<p>There are two blank sections that I invite you to try to complete. These are both important parts of quality assurance. It’s good to check that the distribution of fully observed variables are not different in the missing vs.&nbsp;observed groups of our variables with missing data. Also, it is important to see how our imputed data look if we place it back with the observed data. Do they stand out? I hope not! (I was going to provide code for this, but it’s not new stuff. You can visualize these! … And I really ran out of time this week :( )</p>
<section id="citizenship-had-missing-data-that-was-not-coded-as-na" class="level2">
<h2 class="anchored" data-anchor-id="citizenship-had-missing-data-that-was-not-coded-as-na">Citizenship had missing data that was not coded as <code>NA</code></h2>
<p>I’m using the <code>replace_with_na</code> function to change the missing category to <code>NA</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wbns)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID            FOOD_INSEC      PPAGE         LGBT      XACSNET   
 Length:8142        No  :6015   Min.   :18.00   No  :6852   No : 378  
 Class :character   Yes :2069   1st Qu.:36.00   Yes : 621   Yes:7764  
 Mode  :character   NA's:  58   Median :47.00   NA's: 669             
                                Mean   :45.92                         
                                3rd Qu.:57.00                         
                                Max.   :64.00                         
                                                                      
 PARTNER       FAMSIZE     INSURED     UNMETCARE_Y      PPP20197   
 No :7326   2      :3009   No  : 856   No :6725    Yes      :6825  
 Yes: 816   1      :2753   Yes :7167   Yes:1417    Missing  :   5  
            3      : 986   NA's: 119               No       : 470  
            4      : 880                           Not asked: 842  
            5      : 336                                           
            6      : 114                                           
            (Other):  64                                           
                 PPINCIMP                       PPETHM    
 Less than $5,000    : 717   White, Non-Hispanic   :4738  
 $100,000 to $124,999: 641   2+ Races, Non-Hispanic: 238  
 $15,000 to $19,999  : 511   Black, Non-Hispanic   :1023  
 $20,000 to $24,999  : 499   Hispanic              :1473  
 $60,000 to $74,999  : 443   Other, Non-Hispanic   : 670  
 $150,000 to $174,999: 423                                
 (Other)             :4908                                
                        PPEDUCAT   
 Less than high school      : 613  
 Bachelor's degree or higher:3041  
 High school                :1940  
 Some college               :2548  
                                   
                                   
                                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>wbns_miss <span class="ot">=</span> wbns <span class="sc">%&gt;%</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_with_na</span>(<span class="at">replace =</span> <span class="fu">list</span>(<span class="at">PPP20197 =</span> <span class="st">"Missing"</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If Missing, replace with NA, if not then keep value as is</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wbns_miss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID            FOOD_INSEC      PPAGE         LGBT      XACSNET   
 Length:8142        No  :6015   Min.   :18.00   No  :6852   No : 378  
 Class :character   Yes :2069   1st Qu.:36.00   Yes : 621   Yes:7764  
 Mode  :character   NA's:  58   Median :47.00   NA's: 669             
                                Mean   :45.92                         
                                3rd Qu.:57.00                         
                                Max.   :64.00                         
                                                                      
 PARTNER       FAMSIZE     INSURED     UNMETCARE_Y      PPP20197   
 No :7326   2      :3009   No  : 856   No :6725    Yes      :6825  
 Yes: 816   1      :2753   Yes :7167   Yes:1417    Missing  :   0  
            3      : 986   NA's: 119               No       : 470  
            4      : 880                           Not asked: 842  
            5      : 336                           NA's     :   5  
            6      : 114                                           
            (Other):  64                                           
                 PPINCIMP                       PPETHM    
 Less than $5,000    : 717   White, Non-Hispanic   :4738  
 $100,000 to $124,999: 641   2+ Races, Non-Hispanic: 238  
 $15,000 to $19,999  : 511   Black, Non-Hispanic   :1023  
 $20,000 to $24,999  : 499   Hispanic              :1473  
 $60,000 to $74,999  : 443   Other, Non-Hispanic   : 670  
 $150,000 to $174,999: 423                                
 (Other)             :4908                                
                        PPEDUCAT   
 Less than high school      : 613  
 Bachelor's degree or higher:3041  
 High school                :1940  
 Some college               :2548  
                                   
                                   
                                   </code></pre>
</div>
</div>
</section>
<section id="look-at-the-missing-data-pattern" class="level2">
<h2 class="anchored" data-anchor-id="look-at-the-missing-data-pattern">Look at the missing data pattern</h2>
<p>Now I can look at the missing data pattern.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">md.pattern</span>(wbns_miss, <span class="at">rotate.names =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Missing_data_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     ID PPAGE XACSNET PARTNER FAMSIZE UNMETCARE_Y PPINCIMP PPETHM PPEDUCAT
7331  1     1       1       1       1           1        1      1        1
644   1     1       1       1       1           1        1      1        1
88    1     1       1       1       1           1        1      1        1
16    1     1       1       1       1           1        1      1        1
38    1     1       1       1       1           1        1      1        1
5     1     1       1       1       1           1        1      1        1
14    1     1       1       1       1           1        1      1        1
1     1     1       1       1       1           1        1      1        1
2     1     1       1       1       1           1        1      1        1
3     1     1       1       1       1           1        1      1        1
      0     0       0       0       0           0        0      0        0
     PPP20197 FOOD_INSEC INSURED LGBT    
7331        1          1       1    1   0
644         1          1       1    0   1
88          1          1       0    1   1
16          1          1       0    0   2
38          1          0       1    1   1
5           1          0       1    0   2
14          1          0       0    1   2
1           1          0       0    0   3
2           0          1       1    1   1
3           0          1       1    0   2
            5         58     119  669 851</code></pre>
</div>
</div>
<p>Looks like citizenship, food insecurity, insurance, and identifying as LGBT have missing data.</p>
</section>
<section id="check-the-distributions-of-the-variables-from-the-observed-vs.-missing-data" class="level2">
<h2 class="anchored" data-anchor-id="check-the-distributions-of-the-variables-from-the-observed-vs.-missing-data">Check the distributions of the variables from the observed vs.&nbsp;missing data</h2>
</section>
<section id="use-mice-to-impute-data" class="level2">
<h2 class="anchored" data-anchor-id="use-mice-to-impute-data">Use mice to impute data</h2>
<p>Now we can use the <code>mice()</code> function to impute the data.</p>
<p>Let’s break down what I’m using in the function below:</p>
<ul>
<li><p>I set <code>m=5</code> as the number of imputations that I will be running</p></li>
<li><p>I set <code>print = F</code> so I don’t get the message as it imputes</p></li>
<li><p>I set <code>defaultMethod = c("norm", "logreg", "polyreg", "polr")</code></p>
<ul>
<li>This means <code>mice</code> will determine which method to use based on the type of variable</li>
<li>For binary variables it will use “logreg.” Thus, it will use logistic regression to predict the missing values. This will include food insecurity, insured, and LGBT variables in my data.</li>
<li>For continuous variables, it will use “norm.predict” which will consist of predicting the missing values from linear regression. I don’t have any missing continuous values, so this one is not used.</li>
<li>For multi-level categorical varaibles, we use “polyreg” which is a type of logistic regression that is expanded to handle multiple levels of outcomes. This will include citizenship in my data.</li>
<li>For ordinal variables, we use “polr” which is a proportional odds model, another type of generalized linear regression model that handles ordered categories. I don’t have any missing ordinal variables, so this one is not used.</li>
</ul></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>wbns_MI_5 <span class="ot">=</span> <span class="fu">mice</span>(wbns_miss, <span class="at">m=</span><span class="dv">5</span>, <span class="at">print =</span> F, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">defaultMethod =</span> <span class="fu">c</span>(<span class="st">"norm.predict"</span>, <span class="st">"logreg"</span>, <span class="st">"polyreg"</span>, <span class="st">"polr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 76</code></pre>
</div>
</div>
</section>
<section id="complete-data" class="level2">
<h2 class="anchored" data-anchor-id="complete-data">Complete data</h2>
<p>It’s hard to parse through the output of <code>mice</code>, but we can take a look at one of the imputation’s complete (aka filled in) data. Below I will look at the first imputation (hence the <code>1</code>). You can change the <code>1</code> to anything up to 5 to see the different imputations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>d1 <span class="ot">=</span> <span class="fu">complete</span>(wbns_MI_5, <span class="dv">1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID            FOOD_INSEC     PPAGE        LGBT      XACSNET    PARTNER   
 Length:8142        No :6054   Min.   :18.00   No :7445   No : 378   No :7326  
 Class :character   Yes:2088   1st Qu.:36.00   Yes: 697   Yes:7764   Yes: 816  
 Mode  :character              Median :47.00                                   
                               Mean   :45.92                                   
                               3rd Qu.:57.00                                   
                               Max.   :64.00                                   
                                                                               
    FAMSIZE     INSURED    UNMETCARE_Y      PPP20197   
 2      :3009   No : 877   No :6725    Yes      :6827  
 1      :2753   Yes:7265   Yes:1417    Missing  :   0  
 3      : 986                          No       : 472  
 4      : 880                          Not asked: 843  
 5      : 336                                          
 6      : 114                                          
 (Other):  64                                          
                 PPINCIMP                       PPETHM    
 Less than $5,000    : 717   White, Non-Hispanic   :4738  
 $100,000 to $124,999: 641   2+ Races, Non-Hispanic: 238  
 $15,000 to $19,999  : 511   Black, Non-Hispanic   :1023  
 $20,000 to $24,999  : 499   Hispanic              :1473  
 $60,000 to $74,999  : 443   Other, Non-Hispanic   : 670  
 $150,000 to $174,999: 423                                
 (Other)             :4908                                
                        PPEDUCAT   
 Less than high school      : 613  
 Bachelor's degree or higher:3041  
 High school                :1940  
 Some college               :2548  
                                   
                                   
                                   </code></pre>
</div>
</div>
</section>
<section id="see-how-the-imputed-values-look-within-the-observed-values" class="level2">
<h2 class="anchored" data-anchor-id="see-how-the-imputed-values-look-within-the-observed-values">See how the imputed values look within the observed values</h2>
</section>
<section id="fit-regression-with-imputations" class="level2">
<h2 class="anchored" data-anchor-id="fit-regression-with-imputations">Fit regression with imputations</h2>
<p>Below is how we run a regression model with the output from <code>mice</code> (<code>wbns_MI_5</code>). We use the <code>with</code> function that can be read as: With <code>wbns_MI_5</code>, run the following <code>glm</code> function. It will automatically know to know 5 different regressions, one with each imputed dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">=</span> <span class="fu">with</span>(wbns_MI_5, <span class="fu">glm</span>(FOOD_INSEC <span class="sc">~</span> PPAGE <span class="sc">+</span> LGBT <span class="sc">+</span> XACSNET <span class="sc">+</span> PARTNER <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                   FAMSIZE <span class="sc">+</span> INSURED <span class="sc">+</span> UNMETCARE_Y <span class="sc">+</span> PPP20197 <span class="sc">+</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>                            PPETHM, <span class="at">family =</span> binomial))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once I have fit the regression model with each imputed dataset, I can pool the results. The <code>mice</code> function will use Rubin’s Rules to pool the estimates and variances. Note the use of the <code>pool</code> function!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pooled_reg_MI <span class="ot">=</span> <span class="fu">pool</span>(reg)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>mi_reg <span class="ot">=</span> <span class="fu">summary</span>(pooled_reg_MI, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>mi_reg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           term     estimate   std.error  statistic         df
1                   (Intercept) -0.937930476 0.183644159 -5.1073254 3621.51082
2                         PPAGE  0.004075098 0.002358548  1.7277999 3400.38115
3                       LGBTYes  0.267204630 0.106641668  2.5056306   80.27778
4                    XACSNETYes -0.532969377 0.120918557 -4.4076723 2770.70564
5                    PARTNERYes  0.740565439 0.091897054  8.0586418 7615.21238
6                      FAMSIZE2 -0.662367018 0.071654539 -9.2438948 5978.02824
7                      FAMSIZE3 -0.318385223 0.094241917 -3.3783823 7152.87307
8                      FAMSIZE4 -0.386242762 0.100375683 -3.8479715 7970.35101
9                      FAMSIZE5 -0.096660785 0.140764969 -0.6866821 7724.53666
10                     FAMSIZE6 -0.141698224 0.233709142 -0.6063016 8080.85045
11                     FAMSIZE7 -0.177876415 0.383625529 -0.4636720 8110.70643
12             FAMSIZE8 or more  0.703090607 0.455466925  1.5436700 8078.48213
13                   INSUREDYes -0.255443126 0.087038956 -2.9348138 1230.68547
14               UNMETCARE_YYes  1.639080123 0.065242885 25.1227415 7315.88489
15                   PPP20197No  0.179074669 0.126183836  1.4191570 3355.01475
16            PPP20197Not asked  0.639561784 0.084435763  7.5745367 4080.50853
17 PPETHM2+ Races, Non-Hispanic  0.622280239 0.151540002  4.1063761 6554.45240
18    PPETHMBlack, Non-Hispanic  0.482694291 0.083523795  5.7791230 1789.24314
19               PPETHMHispanic  0.571844693 0.076483630  7.4766940 6510.69455
20    PPETHMOther, Non-Hispanic -0.548466076 0.128972371 -4.2525858 8085.00758
         p.value         2.5 %       97.5 %
1   3.436005e-07 -1.2979867501 -0.577874202
2   8.411490e-02 -0.0005492161  0.008699412
3   1.424530e-02  0.0549922199  0.479417041
4   1.084614e-05 -0.7700689688 -0.295869785
5   8.890769e-16  0.5604218905  0.920708987
6   3.239130e-20 -0.8028357733 -0.521898262
7   7.330297e-04 -0.5031272481 -0.133643199
8   1.200297e-04 -0.5830053645 -0.189480159
9   4.923037e-01 -0.3725982918  0.179276721
10  5.443315e-01 -0.5998283453  0.316431896
11  6.428952e-01 -0.9298808559  0.574128026
12  1.227075e-01 -0.1897419305  1.595923144
13  3.399412e-03 -0.4262042835 -0.084681968
14 1.144568e-133  1.5111852596  1.766974986
15  1.559462e-01 -0.0683303580  0.426479697
16  4.431806e-14  0.4740216271  0.805101941
17  4.068018e-05  0.3252124363  0.919348043
18  8.839157e-09  0.3188798460  0.646508735
19  8.623851e-14  0.4219116603  0.721777726
20  2.136949e-05 -0.8012851257 -0.295647026</code></pre>
</div>
</div>
</section>
<section id="we-can-do-an-informal-sensitivity-analysis" class="level2">
<h2 class="anchored" data-anchor-id="we-can-do-an-informal-sensitivity-analysis">We can do an informal sensitivity analysis</h2>
<p>Here I am simply running a logistic regression model using our complete data. We can compare the estimates from this model to the pooled estimates from the multiply imputed datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>wbns_cc <span class="ot">=</span> wbns_miss <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>reg_cc <span class="ot">=</span> <span class="fu">glm</span>(FOOD_INSEC <span class="sc">~</span> PPAGE <span class="sc">+</span> LGBT <span class="sc">+</span> XACSNET <span class="sc">+</span> PARTNER <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>               FAMSIZE <span class="sc">+</span> INSURED <span class="sc">+</span> UNMETCARE_Y <span class="sc">+</span> PPP20197 <span class="sc">+</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>               PPETHM, <span class="at">family =</span> binomial, <span class="at">data =</span> wbns_cc)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>cc_reg <span class="ot">=</span> <span class="fu">summary</span>(reg_cc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I will put the estimates side-by-side now.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>estimates <span class="ot">=</span> <span class="fu">cbind</span>(<span class="at">Mult_imp =</span> mi_reg<span class="sc">$</span>estimate, </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">Complete_case =</span> cc_reg<span class="sc">$</span>coefficients[,<span class="dv">1</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>estimates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                 Mult_imp Complete_case
(Intercept)                  -0.937930476  -0.923507128
PPAGE                         0.004075098   0.003963706
LGBTYes                       0.267204630   0.253429229
XACSNETYes                   -0.532969377  -0.537266195
PARTNERYes                    0.740565439   0.756557601
FAMSIZE2                     -0.662367018  -0.733347778
FAMSIZE3                     -0.318385223  -0.431279163
FAMSIZE4                     -0.386242762  -0.469643349
FAMSIZE5                     -0.096660785  -0.136786735
FAMSIZE6                     -0.141698224  -0.333273866
FAMSIZE7                     -0.177876415  -0.158287657
FAMSIZE8 or more              0.703090607   0.698218128
INSUREDYes                   -0.255443126  -0.242185879
UNMETCARE_YYes                1.639080123   1.739880532
PPP20197No                    0.179074669   0.239127321
PPP20197Not asked             0.639561784   0.596022881
PPETHM2+ Races, Non-Hispanic  0.622280239   0.641231577
PPETHMBlack, Non-Hispanic     0.482694291   0.457402801
PPETHMHispanic                0.571844693   0.535396844
PPETHMOther, Non-Hispanic    -0.548466076  -0.541533105</code></pre>
</div>
</div>
<p>The most important thing I am noting is that:</p>
<ol type="1">
<li>The complete case estimates have the same signs as the pooled.</li>
<li>For the most part, the magnitude of the estimates have not changed by much. Family size seems to be the most impacted.</li>
</ol>
</section>
<section id="now-we-can-proceed-with-the-other-parts-of-lab-3" class="level2">
<h2 class="anchored" data-anchor-id="now-we-can-proceed-with-the-other-parts-of-lab-3">Now we can proceed with the other parts of Lab 3</h2>
<p>Below is some sample code for how I would make a tidy dataset or an odds ratio table from the pooled results! From <code>reg</code> and <code>pooled_reg_MI</code> you should be able to do everything else in Lab 3!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(pooled_reg_MI, <span class="at">exponentiate=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           term  estimate   std.error  statistic       p.value
1                   (Intercept) 0.3914371 0.183644159 -5.1073254  3.436005e-07
2                         PPAGE 1.0040834 0.002358548  1.7277999  8.411490e-02
3                       LGBTYes 1.3063077 0.106641668  2.5056306  1.424530e-02
4                    XACSNETYes 0.5868598 0.120918557 -4.4076723  1.084614e-05
5                    PARTNERYes 2.0971210 0.091897054  8.0586418  8.890769e-16
6                      FAMSIZE2 0.5156294 0.071654539 -9.2438948  3.239130e-20
7                      FAMSIZE3 0.7273226 0.094241917 -3.3783823  7.330297e-04
8                      FAMSIZE4 0.6796055 0.100375683 -3.8479715  1.200297e-04
9                      FAMSIZE5 0.9078639 0.140764969 -0.6866821  4.923037e-01
10                     FAMSIZE6 0.8678831 0.233709142 -0.6063016  5.443315e-01
11                     FAMSIZE7 0.8370459 0.383625529 -0.4636720  6.428952e-01
12             FAMSIZE8 or more 2.0199861 0.455466925  1.5436700  1.227075e-01
13                   INSUREDYes 0.7745732 0.087038956 -2.9348138  3.399412e-03
14               UNMETCARE_YYes 5.1504296 0.065242885 25.1227415 1.144568e-133
15                   PPP20197No 1.1961101 0.126183836  1.4191570  1.559462e-01
16            PPP20197Not asked 1.8956500 0.084435763  7.5745367  4.431806e-14
17 PPETHM2+ Races, Non-Hispanic 1.8631717 0.151540002  4.1063761  4.068018e-05
18    PPETHMBlack, Non-Hispanic 1.6204344 0.083523795  5.7791230  8.839157e-09
19               PPETHMHispanic 1.7715320 0.076483630  7.4766940  8.623851e-14
20    PPETHMOther, Non-Hispanic 0.5778355 0.128972371 -4.2525858  2.136949e-05
              b         df dfcom         fmi       lambda m          riv
1  6.881461e-04 3621.51082  8122 0.025023713 0.0244854257 5 0.0251000102
2  1.200467e-07 3400.38115  8122 0.026468993 0.0258965607 5 0.0265850213
3  2.101980e-03   80.27778  8122 0.240486487 0.2217971585 5 0.2850120132
4  3.726763e-04 2770.70564  8122 0.031285310 0.0305863079 5 0.0315513471
5  3.850978e-05 7615.21238  8122 0.005733130 0.0054720377 5 0.0055021456
6  5.578644e-05 5978.02824  8122 0.013368377 0.0130383463 5 0.0132105905
7  5.859371e-05 7152.87307  8122 0.008193975 0.0079166967 5 0.0079798710
8  2.354474e-05 7970.35101  8122 0.003054391 0.0028042591 5 0.0028121451
9  7.893745e-05 7724.53666  8122 0.005038097 0.0047805200 5 0.0048034832
10 5.998177e-05 8080.85045  8122 0.001564880 0.0013177987 5 0.0013195376
11 6.675022e-05 8110.70643  8122 0.000790638 0.0005442757 5 0.0005445721
12 2.357154e-04 8078.48213  8122 0.001610643 0.0013635010 5 0.0013653627
13 3.298855e-04 1230.68547  8122 0.053790159 0.0522537123 5 0.0551347053
14 2.523622e-05 7315.88489  8122 0.007385738 0.0071144161 5 0.0071653937
15 3.476233e-04 3355.01475  8122 0.026778865 0.0261988792 5 0.0269037267
16 1.297113e-04 4080.50853  8122 0.022311721 0.0218326393 5 0.0223199425
17 2.028729e-04 6554.45240  8122 0.010902859 0.0106010955 5 0.0107146829
18 2.412188e-04 1789.24314  8122 0.042562349 0.0414927315 5 0.0432889064
19 5.259138e-05 6510.69455  8122 0.011092177 0.0107884438 5 0.0109061037
20 1.710847e-05 8085.00758  8122 0.001481213 0.0012342385 5 0.0012357637
           ubar
1  3.289940e-02
2  5.418691e-06
3  8.850069e-03
4  1.417409e-02
5  8.398857e-03
6  5.067429e-03
7  8.811227e-03
8  1.004702e-02
9  1.972005e-02
10 5.454798e-02
11 1.470884e-01
12 2.071673e-01
13 7.179917e-03
14 4.226351e-03
15 1.550521e-02
16 6.973744e-03
17 2.272092e-02
18 6.686762e-03
19 5.786636e-03
20 1.661334e-02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(reg, <span class="at">exponentiate =</span> T) <span class="co"># Note I am not using the pooled results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="cebdbdggrj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#cebdbdggrj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#cebdbdggrj thead, #cebdbdggrj tbody, #cebdbdggrj tfoot, #cebdbdggrj tr, #cebdbdggrj td, #cebdbdggrj th {
  border-style: none;
}

#cebdbdggrj p {
  margin: 0;
  padding: 0;
}

#cebdbdggrj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#cebdbdggrj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#cebdbdggrj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#cebdbdggrj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#cebdbdggrj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cebdbdggrj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cebdbdggrj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#cebdbdggrj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#cebdbdggrj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#cebdbdggrj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#cebdbdggrj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#cebdbdggrj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#cebdbdggrj .gt_spanner_row {
  border-bottom-style: hidden;
}

#cebdbdggrj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#cebdbdggrj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#cebdbdggrj .gt_from_md > :first-child {
  margin-top: 0;
}

#cebdbdggrj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#cebdbdggrj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#cebdbdggrj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#cebdbdggrj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#cebdbdggrj .gt_row_group_first td {
  border-top-width: 2px;
}

#cebdbdggrj .gt_row_group_first th {
  border-top-width: 2px;
}

#cebdbdggrj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cebdbdggrj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#cebdbdggrj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#cebdbdggrj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cebdbdggrj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#cebdbdggrj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#cebdbdggrj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#cebdbdggrj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#cebdbdggrj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#cebdbdggrj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cebdbdggrj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cebdbdggrj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#cebdbdggrj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#cebdbdggrj .gt_left {
  text-align: left;
}

#cebdbdggrj .gt_center {
  text-align: center;
}

#cebdbdggrj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#cebdbdggrj .gt_font_normal {
  font-weight: normal;
}

#cebdbdggrj .gt_font_bold {
  font-weight: bold;
}

#cebdbdggrj .gt_font_italic {
  font-style: italic;
}

#cebdbdggrj .gt_super {
  font-size: 65%;
}

#cebdbdggrj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#cebdbdggrj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#cebdbdggrj .gt_indent_1 {
  text-indent: 5px;
}

#cebdbdggrj .gt_indent_2 {
  text-indent: 10px;
}

#cebdbdggrj .gt_indent_3 {
  text-indent: 15px;
}

#cebdbdggrj .gt_indent_4 {
  text-indent: 20px;
}

#cebdbdggrj .gt_indent_5 {
  text-indent: 25px;
}

#cebdbdggrj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#cebdbdggrj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>OR</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">PPAGE</td>
<td class="gt_row gt_center" headers="estimate">1.00</td>
<td class="gt_row gt_center" headers="conf.low">1.00, 1.01</td>
<td class="gt_row gt_center" headers="p.value">0.084</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">LGBT</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;No</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Yes</td>
<td class="gt_row gt_center" headers="estimate">1.31</td>
<td class="gt_row gt_center" headers="conf.low">1.06, 1.62</td>
<td class="gt_row gt_center" headers="p.value">0.014</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">XACSNET</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;No</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Yes</td>
<td class="gt_row gt_center" headers="estimate">0.59</td>
<td class="gt_row gt_center" headers="conf.low">0.46, 0.74</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">PARTNER</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;No</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Yes</td>
<td class="gt_row gt_center" headers="estimate">2.10</td>
<td class="gt_row gt_center" headers="conf.low">1.75, 2.51</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">FAMSIZE</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;1</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2</td>
<td class="gt_row gt_center" headers="estimate">0.52</td>
<td class="gt_row gt_center" headers="conf.low">0.45, 0.59</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;3</td>
<td class="gt_row gt_center" headers="estimate">0.73</td>
<td class="gt_row gt_center" headers="conf.low">0.60, 0.87</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;4</td>
<td class="gt_row gt_center" headers="estimate">0.68</td>
<td class="gt_row gt_center" headers="conf.low">0.56, 0.83</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;5</td>
<td class="gt_row gt_center" headers="estimate">0.91</td>
<td class="gt_row gt_center" headers="conf.low">0.69, 1.20</td>
<td class="gt_row gt_center" headers="p.value">0.5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;6</td>
<td class="gt_row gt_center" headers="estimate">0.87</td>
<td class="gt_row gt_center" headers="conf.low">0.55, 1.37</td>
<td class="gt_row gt_center" headers="p.value">0.5</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;7</td>
<td class="gt_row gt_center" headers="estimate">0.84</td>
<td class="gt_row gt_center" headers="conf.low">0.39, 1.78</td>
<td class="gt_row gt_center" headers="p.value">0.6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;8 or more</td>
<td class="gt_row gt_center" headers="estimate">2.02</td>
<td class="gt_row gt_center" headers="conf.low">0.83, 4.93</td>
<td class="gt_row gt_center" headers="p.value">0.12</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">INSURED</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;No</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Yes</td>
<td class="gt_row gt_center" headers="estimate">0.77</td>
<td class="gt_row gt_center" headers="conf.low">0.65, 0.92</td>
<td class="gt_row gt_center" headers="p.value">0.003</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">UNMETCARE_Y</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;No</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Yes</td>
<td class="gt_row gt_center" headers="estimate">5.15</td>
<td class="gt_row gt_center" headers="conf.low">4.53, 5.85</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">PPP20197</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Yes</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;No</td>
<td class="gt_row gt_center" headers="estimate">1.20</td>
<td class="gt_row gt_center" headers="conf.low">0.93, 1.53</td>
<td class="gt_row gt_center" headers="p.value">0.2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Not asked</td>
<td class="gt_row gt_center" headers="estimate">1.90</td>
<td class="gt_row gt_center" headers="conf.low">1.61, 2.24</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">PPETHM</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;White, Non-Hispanic</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;2+ Races, Non-Hispanic</td>
<td class="gt_row gt_center" headers="estimate">1.86</td>
<td class="gt_row gt_center" headers="conf.low">1.38, 2.51</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Black, Non-Hispanic</td>
<td class="gt_row gt_center" headers="estimate">1.62</td>
<td class="gt_row gt_center" headers="conf.low">1.38, 1.91</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Hispanic</td>
<td class="gt_row gt_center" headers="estimate">1.77</td>
<td class="gt_row gt_center" headers="conf.low">1.52, 2.06</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Other, Non-Hispanic</td>
<td class="gt_row gt_center" headers="estimate">0.58</td>
<td class="gt_row gt_center" headers="conf.low">0.45, 0.74</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
</tbody><tfoot class="gt_footnotes">
<tr class="odd">
<td colspan="4" class="gt_footnote"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;"><sup>1</sup></span> OR = Odds Ratio, CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tble_regression will automatically pool them!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>